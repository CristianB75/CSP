# Basic Timer Counter \(TC\)

A Timer Counter \(TC\) module can operate in any one of the below three modes.<br />Timer mode - is used for periodic delay.<br />Compare mode is used to generate waveforms on WO and WO<br />Capture mode is used to measure delay, pulse width and frequency of the input signal. Capture trigger can be provided by input event line.

**Timer mode**

The TC in timer mode is used for periodic interrupt generation.<br />This provides below features:

-   Selectable 8/16/32 bit counter

-   Interrupts/output events on:

-   Counter overflow/underflow

-   Compare match


**Using The Library**

When the timer is enabled, it increments by one on every rising edge of the input clock, and generates an interrupt on a period match \(period is controlled by CC0 in MPWM waveform mode\). Timer mode is used for periodic interrupt generation.

It provides both polling and callback methods to indicate period match has occurred.

-   With polling, the application will need to continuously poll to check if the timer has expired

-   With callback, the registered callback function will be called when the timer expires\(Application do not have to poll continuously\)


**Polling method**

This example demonstrates how to check if timer period is expired by<br />polling the status.

```
int main(void)
{

    /* Start the timer instance 3*/
    TC3_TimerStart();

    while (1)
    {
       while(! TC3_TimerPeriodHasExpired());
       LED_Toggle();
    }

}
```

**Callback method**

This example demonstrates how to use TC in timer mode to<br />generate periodic callback.

```c
/* This function is called after period expires */
void TC3_Callback_InterruptHandler(TC_TIMER_STATUS status, uintptr_t context)
{
    /* Toggle LED */
    LED_Toggle();
}

int main ( void )
{
    /* Initialize all modules */
    SYS_Initialize ( NULL );

    /* Register callback function for TC3 period interrupt */
    TC3_TimerCallbackRegister(TC3_Callback_InterruptHandler, (uintptr_t)NULL);

    /* Start the timer*/
    TC3_TimerStart();

    while ( true )
    {
        /* Maintain state machines of all polled MPLAB Harmony modules. */
        SYS_Tasks ( );
    }

    /* Execution should not come here during normal operation */

    \return ( EXIT_FAILURE );
}
```

**Library Interface**

Basic Timer Counter peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|TCx\_TimerInitialize|Initializes given instance of TC|
|TCx\_TimerStart|Starts the timer for given TC instance|
|TCx\_TimerStop|Stops the timer for given TC instance|
|TCx\_Timer8bitPeriodSet|Sets the period value of a given timer|
|TCx\_Timer8bitPeriodGet|Reads the period value of given timer|
|TCx\_Timer8bitCounterGet|Reads the timer current count value|
|TCx\_Timer8bitCounterSet|Sets new timer counter value|
|TCx\_Timer8bitCompareSet|Sets the compare value of a given timer|
|TCx\_Timer16bitPeriodSet|Sets the period value of a given timer|
|TCx\_Timer16bitPeriodGet|Reads the period value of given timer|
|TCx\_Timer16bitCounterGet|Reads the timer current count value|
|TCx\_Timer16bitCounterSet|Sets new timer counter value|
|TCx\_Timer16bitCompareSet|Sets the compare value of a given timer|
|TCx\_Timer32bitPeriodSet|Sets the period value of a given timer|
|TCx\_Timer32bitPeriodGet|Reads the period value of given timer|
|TCx\_Timer32bitCounterGet|Reads the timer current count value|
|TCx\_Timer32bitCounterSet|Sets new timer counter value|
|TCx\_Timer32bitCompareSet|Sets the compare value of a given timer|
|TCx\_TimerPeriodHasExpired|Checks whether timer period is elapsed|
|TCx\_TimerFrequencyGet|Provides the given timer's counter-increment frequency|
|TCx\_TimerCallbackRegister|Registers the function to be called from interrupt|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TC\_TIMER\_STATUS|Typedef|Identifies channel interrupt source mask|
|TC\_TIMER\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the TC channel callback function|

**Compare mode**

The TC channel in compare mode is used for waveform generation. This provides below features:

-   Selectable 8/16/32 bit counter

-   2 compare/capture channels \(CC\)

-   Waveform configurations

    -   Normal Frequency - Period controlled by MAX \(by PER in 8-bit mode\)

    -   Match Frequency - Period controlled by CC0 to generates 50% duty cycle waveform

    -   Normal PWM - Period controlled by MAX \(by PER in 8-bit mode\) and duty controlled by CCx

    -   Match PWM - Period controlled by CC0 and duty controlled by CC1

-   Interrupts/output events on:

    -   Counter overflow/underflow

    -   Compare match


**Using The Library**

When using the TC and the Compare/Capture Value registers \(CCx\) for compare operations, the counter value is continuously compared to the values in the CCx registers. Output polarity can be reversed by inverting the output waveforms. This library provides below waveform types:

|Name|Operation|TOP|Update|Output on match|Output on update|
|----|---------|---|------|---------------|----------------|
|MFRQ \(output on WO \)|Match Frequency|CC0|TOP/ZERO|Toggle|Stable|
|MPWM \(output on WO \)|Match PWM|CC0|TOP/ZERO|Toggle|Toggle|

In compare mode, overflow interrupt and compare match interrupts can be used to change the frequency or duty cycle of the waveform.

**Library Interface**

Basic Timer Counter peripheral library provides the following interfaces for compare operations:

**Functions**

|Name|Description|
|----|-----------|
|TCx\_CompareInitialize|Initializes given instance of TC|
|TCx\_CompareStart|Starts the timer for given TC instance|
|TCx\_CompareStop|Stops the timer for given TC instance|
|TCx\_Compare8bitPeriodSet|Sets the period value of a given timer|
|TCx\_Compare8bitPeriodGet|Reads the period value of given timer|
|TCx\_Compare8bitCounterGet|Reads the timer current count value|
|TCx\_Compare8bitCounterSet|Sets new timer counter value|
|TCx\_Compare8bitMatch0Set|Writes compare value of the given compare channel 0|
|TCx\_Compare8bitMatch1Set|Writes compare value of the given compare channel 1|
|TCx\_Compare16bitPeriodSet|Sets the period value of a given timer|
|TCx\_Compare16bitPeriodGet|Reads the period value of given timer|
|TCx\_Compare16bitCounterGet|Reads the timer current count value|
|TCx\_Compare16bitCounterSet|Sets new timer counter value|
|TCx\_Compare16bitMatch0Set|Writes compare value of the given compare channel 0|
|TCx\_Compare16bitMatch1Set|Writes compare value of the given compare channel 1|
|TCx\_Compare32bitPeriodSet|Sets the period value of a given timer|
|TCx\_Compare32bitPeriodGet|Reads the period value of given timer|
|TCx\_Compare32bitCounterGet|Reads the timer current count value|
|TCx\_Compare32bitCounterSet|Sets new timer counter value|
|TCx\_Compare32bitMatch0Set|Writes compare value of the given compare channel 0|
|TCx\_Compare32bitMatch1Set|Writes compare value of the given compare channel 1|
|TCx\_CompareFrequencyGet|Provides the given timer's counter-increment frequency|
|TCx\_CompareCallbackRegister|Registers the function to be called from interrupt|
|TCx\_CompareStatusGet|Reads status of compare operation|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCx\_COMPARE\_STATUS|Typedef|Identifies channel interrupt source mask|
|TCx\_COMPARE\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tc channel callback function|

**Capture mode**

The TC channel in capture mode is used to measure pulse width, period,<br />timestamp. A capture trigger can be provided by input event line TC\_EV.<br />This provides below features:

-   Selectable 8/16/32 bit counter

-   Input capture

    -   Period captured in CC0 and pulse width in CC1

    -   Period captured in CC1 and pulse width in CC0

-   Interrupts/output events on:

    -   Capture

-   DMA support


**Using The Library**

Capture trigger can be provided by

-   Input event line TC\_EV

    -   Only one event input line is available

    -   This provides different capture event actions:

        -   Pulse width in CC0 and period in CC1

        -   Pulse width in CC1 and period in CC0


It provides both polling and callback methods to indicate capture event<br />has occurred.

-   With polling, the application will need to continuously poll to check if the capture event has occurred.

-   With callback, the registered callback function will be called when the capture event occurs. This means the application do not have to poll continuously.


**Callback method**

This example demonstrates how to use TC in capture mode to measure on time and period. CC0 captures on time and CC1 captures period of the input event. Event action is configured as PWP \(Pulse width in CC0 and period in CC1\).

```c
/ * This function is called after Capture 0 interrupt  */
void TC3_CaptureInterruptHandler(TC_CAPTURE_STATUS status, uintptr_t context)
{
    / * Read Captured values  */
    on_time = TC3_Capture16bitChannel0Get();
    period = TC3_Capture16bitChannel1Get();
}

int main(void)
{

    / * Register callback function for period interrupt  */
    TC3_CaptureCallbackRegister(TC3_CaptureInterruptHandler, (uintptr_t)NULL);

    / * Start the Capture  */
    TC3_CaptureStart();
}
```

**Library Interface**

Basic Timer Counter peripheral library provides the following interfaces for capture operations:

**Functions**

|Name|Description|
|----|-----------|
|TCx\_CaptureInitialize|Initializes given instance of TC|
|TCx\_CaptureStart|Starts the timer for given TC instance|
|TCx\_CaptureStop|Stops the timer for given TC instance|
|TCx\_Capture8bitChannel0Get|Reads capture value from channel 0|
|TCx\_Capture16bitChannel0Get|Reads capture value from channel 0|
|TCx\_Capture32bitChannel0Get|Reads capture value from channel 0|
|TCx\_Capture8bitChannel1Get|Reads capture value from channel 1|
|TCx\_Capture16bitChannel1Get|Reads capture value from channel 1|
|TCx\_Capture32bitChannel1Get|Reads capture value from channel 1|
|TCx\_CaptureStatusGet|Reads status capture operation|
|TCx\_CaptureCallbackRegister|Registers the function to be called from interrupt|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCx\_CAPTURE\_STATUS|Typedef|Identifies channel interrupt source mask|
|TCx\_CAPTURE\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tc channel callback function|

-   **[TCx\_TimerInitialize Function](GUID-D435CE06-4652-46EC-AF3D-4536D2B8A018.md)**  

-   **[TCx\_TimerStart Function](GUID-FA0EA280-306B-4C98-8281-D47CA76B41B0.md)**  

-   **[TCx\_TimerStop Function](GUID-78E4D379-5205-493A-80B4-6A31D6C903C7.md)**  

-   **[TCx\_Timer16bitCompareSet Function](GUID-E375D886-92E7-4033-ADB1-4FD3DE1B4DF3.md)**  

-   **[TCx\_Timer16bitCounterGet Function](GUID-548FB0CF-EDD4-45C9-BF03-47A31119D58B.md)**  

-   **[TCx\_Timer16bitCounterSet Function](GUID-9BC401BC-4843-486D-A86C-CD4298815C88.md)**  

-   **[TCx\_Timer16bitPeriodGet Function](GUID-B06AEB59-E75F-4794-89BC-321B14DE89FE.md)**  

-   **[TCx\_Timer16bitPeriodSet Function](GUID-0B002BB9-D18A-4775-8F4C-5CB3C2A0E39F.md)**  

-   **[TCx\_Timer32bitCompareSet Function](GUID-C266D236-C49B-444A-B405-6F886F3E2DD3.md)**  

-   **[TCx\_Timer32bitCounterGet Function](GUID-6248E09D-A57A-4A1B-8859-9247FAF717D9.md)**  

-   **[TCx\_Timer32bitCounterSet Function](GUID-AFA51B21-3FF6-4F12-8AF9-03017534E988.md)**  

-   **[TCx\_Timer32bitPeriodGet Function](GUID-52E9ADF9-C9C2-4699-A626-2FE3022C93E5.md)**  

-   **[TCx\_Timer32bitPeriodSet Function](GUID-FD84F238-509C-4994-935D-53AFEF520F4A.md)**  

-   **[TCx\_Timer8bitCompareSet Function](GUID-FEAD0389-7D27-4DB2-A888-0493EBC8870E.md)**  

-   **[TCx\_Timer8bitCounterGet Function](GUID-C6593138-94A5-4FEA-B487-1CB9612DF4C5.md)**  

-   **[TCx\_Timer8bitCounterSet Function](GUID-758E095F-2C9F-404F-B338-C5A60752EB4F.md)**  

-   **[TCx\_Timer8bitPeriodGet Function](GUID-150DDADB-9C15-4364-823F-9CC7C5B2920D.md)**  

-   **[TCx\_Timer8bitPeriodSet Function](GUID-E94918BC-EE87-49A9-9D38-8E83C308334B.md)**  

-   **[TCx\_TimerCallbackRegister Function](GUID-A2F4DD59-82BD-4F56-B960-3794701CDE90.md)**  

-   **[TCx\_TimerFrequencyGet Function](GUID-EB986B8F-1012-48AB-8707-54316E54BC24.md)**  

-   **[TCx\_TimerPeriodHasExpired Function](GUID-69B2D1BE-019A-4E23-BDFB-7BE4E1D7542B.md)**  

-   **[TCx\_CompareInitialize Function](GUID-6FC07C17-072E-46CE-818B-3C016BC1E9D7.md)**  

-   **[TCx\_CompareStart Function](GUID-E376AFE2-F739-40B2-A3ED-995A76A627F1.md)**  

-   **[TCx\_CompareStatusGet Function](GUID-7D2A2B25-7494-4AB5-AD4A-AF3D57F7A66A.md)**  

-   **[TCx\_CompareStop Function](GUID-8A3929D3-9B78-402A-9DAB-F000CEAD8985.md)**  

-   **[TCx\_Compare16bitCounterGet Function](GUID-38F6582B-41EF-43F2-B044-FC81E9C97FB6.md)**  

-   **[TCx\_Compare16bitCounterSet Function](GUID-8A8EB9DB-BA69-414C-8B86-B13FCDE97B9C.md)**  

-   **[TCx\_Compare16bitMatch0Set Function](GUID-30AB285A-3336-46EB-9AD3-51071EC1A1ED.md)**  

-   **[TCx\_Compare16bitMatch1Set Function](GUID-CA889B6C-5390-459F-A51A-772214684D16.md)**  

-   **[TCx\_Compare16bitPeriodGet Function](GUID-F6EE543A-1273-49BF-A4E2-EE814F5D83DE.md)**  

-   **[TCx\_Compare16bitPeriodSet Function](GUID-7EB28BAD-53E4-4985-B8D7-B142B44ADE5B.md)**  

-   **[TCx\_Compare32bitCounterGet Function](GUID-A01026B3-BEF1-44B4-AF21-90F9D3B7369B.md)**  

-   **[TCx\_Compare32bitCounterSet Function](GUID-96D4B4B1-5F0F-4D1E-A876-D26DE26DCE63.md)**  

-   **[TCx\_Compare32bitMatch0Set Function](GUID-2BA52BC8-AC14-4A96-AB19-F883DE7DC37C.md)**  

-   **[TCx\_Compare32bitMatch1Set Function](GUID-A5411F5C-A912-4681-B8A0-C0E220B3044A.md)**  

-   **[TCx\_Compare32bitPeriodGet Function](GUID-EC020C30-472C-426C-BC67-AD82570B3670.md)**  

-   **[TCx\_Compare32bitPeriodSet Function](GUID-1360FC29-7DE5-4147-B5A4-C9D169468137.md)**  

-   **[TCx\_Compare8bitCounterGet Function](GUID-1D4CEF06-CCF6-4C4B-924E-D02AB01FAE78.md)**  

-   **[TCx\_Compare8bitCounterSet Function](GUID-F4DDEED4-EAF8-4EA6-8303-9ADA98AA5FA4.md)**  

-   **[TCx\_Compare8bitMatch0Set Function](GUID-46044A18-0D17-4C36-B687-E7A025976796.md)**  

-   **[TCx\_Compare8bitMatch1Set Function](GUID-EE8C3136-7888-45C2-B25F-77DCA3242DF0.md)**  

-   **[TCx\_Compare8bitPeriodGet Function](GUID-5BF9B932-EF5D-4D94-A3C0-B39E7CE14DAE.md)**  

-   **[TCx\_Compare8bitPeriodSet Function](GUID-8FBDF910-C95E-497C-8172-69D8D3293C65.md)**  

-   **[TCx\_CompareCallbackRegister Function](GUID-6E2BFAD3-33FB-42FC-B307-E666B2E2CBB5.md)**  

-   **[TCx\_CompareFrequencyGet Function](GUID-59F0C1A1-E18E-46AE-968A-36F80C8DF75F.md)**  

-   **[TCx\_CaptureInitialize Function](GUID-73F57AC7-58AF-42EF-95EB-4A85EC786C12.md)**  

-   **[TCx\_CaptureStart Function](GUID-831378B6-3045-40BA-BCE4-34D2D1FF332E.md)**  

-   **[TCx\_CaptureStatusGet Function](GUID-FF9BE51F-4F53-4765-99A1-6B9E02157C3D.md)**  

-   **[TCx\_CaptureStop Function](GUID-769BCBED-8105-4DD3-85D1-61CA31BD031C.md)**  

-   **[TCx\_Capture16bitChannel0Get Function](GUID-993E17DC-6E26-42FB-9034-4A3AF32EFD0D.md)**  

-   **[TCx\_Capture16bitChannel1Get Function](GUID-162C8ABC-C2A4-43AE-B3AF-DA6E21AC80FF.md)**  

-   **[TCx\_Capture32bitChannel0Get Function](GUID-3EBD9104-E26D-42F4-A212-7D4CD4049F71.md)**  

-   **[TCx\_Capture32bitChannel1Get Function](GUID-73411681-E312-4251-B502-33246AC5EB63.md)**  

-   **[TCx\_Capture8bitChannel0Get Function](GUID-450234B9-E8A0-45AE-A307-B8562B881C36.md)**  

-   **[TCx\_Capture8bitChannel1Get Function](GUID-58A2A380-6A13-4979-9FF7-FE3E8BE0D9D4.md)**  

-   **[TCx\_CaptureCallbackRegister Function](GUID-9E6E3B0C-30BD-4816-B583-8F9D780DE813.md)**  

-   **[TC\_TIMER Macros and Typedefs](GUID-A48F56DF-3B73-4A7A-B6A9-5BA3DF66D12A.md)**  

-   **[TC\_TIMER\_CALLBACK Typedef](GUID-728DB2A3-5AB5-4DE0-A517-22A17B31B31E.md)**  

-   **[TC\_COMPARE Macros and Typedefs](GUID-BA629E0E-ACCB-4B13-88A7-5ADEA36DC12B.md)**  

-   **[TC\_COMPARE\_CALLBACK Typedef](GUID-C6C2CC30-669D-4327-A433-6B11CFBBC90A.md)**  

-   **[TC\_CAPTURE Macros and Typedefs](GUID-3F5A9419-2B2F-4DDB-802D-108232281F2B.md)**  

-   **[TC\_CAPTURE\_CALLBACK Typedef](GUID-E01AD9A5-A1FF-4891-A487-856A8D4A6B38.md)**  


**Parent topic:**[PIC32CM JH00 JH01 Peripheral Libraries](GUID-05924E45-D6B3-4F33-A5EA-9B080FC421D8.md)

**Parent topic:**[PIC32CM LE00 LS00 LS60 Peripheral Libraries](GUID-F80F1B47-C3E4-4803-ACB6-D30AC5EB7B45.md)

**Parent topic:**[PIC32CM MC00 Peripheral Libraries](GUID-ADF45DC0-B32C-4D1F-9332-59EC0DF5097E.md)

**Parent topic:**[PIC32CX BZ2 WBZ45 Peripheral Libraries](GUID-3D519D00-FDEE-4A3E-9EF7-20F335E64CEE.md)

**Parent topic:**[PIC32CX BZ3 WBZ3 Peripheral Libraries](GUID-5752DD6D-6E5D-484D-B564-DA87788492F3.md)

**Parent topic:**[SAM C20 C21 Peripheral Libraries](GUID-49072E61-B7F2-4B32-952E-D6F5FB361AFB.md)

**Parent topic:**[SAM D09 D10 D11 Peripheral Libraries](GUID-F4788319-C5F3-4EB3-8CC7-05770A2EBD32.md)

**Parent topic:**[SAM D20 D21 Peripheral Libraries](GUID-86A69A90-EDAB-465F-A03A-57CD8BF54AE8.md)

**Parent topic:**[SAM D51 E51 E53 E54 Peripheral Libraries](GUID-E33B93DD-6680-477E-AA96-966208DC9A50.md)

**Parent topic:**[SAM DA1 Peripheral Libraries](GUID-0CDE5F35-9BE3-4484-8299-98161C496C00.md)

**Parent topic:**[SAM HA1 Peripheral Libraries](GUID-7E583BB3-CBFA-4862-8ED5-40D747167457.md)

**Parent topic:**[SAM L1X Peripheral Libraries](GUID-D259BBBC-6BC2-4F69-849B-C06DF4DDD5F8.md)

**Parent topic:**[SAM L21 Peripheral Libraries](GUID-230EF724-3CDA-4F88-8E42-0EF4C1CA112D.md)

**Parent topic:**[SAM L22 Peripheral Libraries](GUID-C3997EBF-87A0-4DD9-BCB0-C8A58B62E44B.md)

