# Pulse Width Modulation Controller \(PWM\)

The Pulse Width Modulation Controller \(PWM\) generates output pulses on four channels independently according to parameters defined per channel. Each channel controls two complementary square output waveforms. Characteristics of the output waveforms such as period, duty-cycle, polarity and dead-times are configured through the user interface. Each channel selects and uses one of the clocks provided by the clock generator. The clock generator provides several clocks resulting from the division of the PWM peripheral clock. External triggers can be managed to allow output pulses to be modified in real time.<br />Channels can be linked together as synchronous channels to be able to update their duty-cycle or dead-time at the same time.<br />The PWM provides eight independent comparison units capable of comparing a programmed value to the counter of the synchronous channels \(counter of channel 0\). These comparisons are intended to generate software interrupts, to trigger pulses on the two independent event lines \(in order to synchronize ADC conversions with a lot of flexibility independently of the PWM outputs\) and to trigger DMA Controller transfer requests.<br />The PWM provides a fault protection mechanism with eight fault inputs, capable to detect a fault condition and to override the PWM outputs asynchronously \(outputs forced to ‘0’, ‘1’ or Hi-Z\).

**Using The Library**

This example shows how to configure the PWM to generate three phase PWM signals with dead time for a motor control application. The duty cycle of the PWM is updated in the interrupt handler.

```c
/* Duty cycle increment value */
#define DUTY_INCREMENT (10U)

/* Save PWM period */
uint16_t period;

/* This function is called after PWM0 counter event */
void PWM_CounterEventHandler(uintptr_t context)
{
    static uint16_t duty0 = 0U;
    static uint16_t duty1 = 2500U;
    static uint16_t duty2 = 5000U;

    PWMx_ChannelDutySet(PWM_CHANNEL_0, duty0);
    PWMx_ChannelDutySet(PWM_CHANNEL_1, duty1);
    PWMx_ChannelDutySet(PWM_CHANNEL_2, duty2);

    /* Increment duty cycle values */
    duty0 += DUTY_INCREMENT;
    duty1 += DUTY_INCREMENT;
    duty2 += DUTY_INCREMENT;

    if (duty0 > period)
        duty0 = 0U;
    if (duty1 > period)
        duty1 = 0U;
    if (duty2 > period)
        duty2 = 0U;
}

int main ( void )
{
    /* Register callback function for Channel 0 counter event */
    PWMx_CallbackRegister(PWM_CounterEventHandler, (uintptr_t)NULL);

    /* Read the period */
    period = PWM0_ChannelPeriodGet(PWM_CHANNEL_0);

    /* Start all synchronous channels by starting channel 0*/
    PWMx_ChannelsStart(PWM_CHANNEL_0_MASK);
}
```

**Library Interface**

Pulse Width Modulation Controller peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|PWMx\_Initialize|Initializes given instance of PWM peripheral|
|PWMx\_ChannelsStart|Starts the given PWM channels|
|PWMx\_ChannelsStop|Stops the given PWM channels|
|PWMx\_ChannelPeriodSet|Sets the period value of given PWM channel|
|PWMx\_ChannelPeriodGet|Reads the period value of given PWM channel|
|PWMx\_ChannelDutySet|Writes the duty cycle value of given PWM channel|
|PWMx\_ChannelDeadTimeSet|Writes dead time values of given PWM channel|
|PWMx\_CompareValueSet|Writes the compare value for given PWM peripheral and given comparison unit|
|PWMx\_ChannelCounterEventEnable|Enables counter event of given channels|
|PWMx\_ChannelCounterEventDisable|Disables counter event of given channels|
|PWMx\_ChannelCounterEventStatusGet|Disables counter event of given channels|
|PWMx\_SyncUpdateEnable|This sets the synchronous update unlock bit|
|PWMx\_FaultStatusClear|This function clears the status of the given fault id|
|PWMx\_CallbackRegister|Registers the function to be called from interrupt|
|PWMx\_ChannelOverrideEnable|This function overrides the PWM output|
|PWMx\_ChannelOverrideDisable|This function select dead-time output as the PWM output|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|PWM\_CALLBACK|Typedef|Defines the data type and function signature for the PWM peripheral callback function|
|PWM\_CHANNEL\_NUM|Enum|Identifies PWM channel number in a PWM peripheral|
|PWM\_CHANNEL\_MASK|Enum|Identifies PWM channel mask|
|PWM\_COMPARE|Enum|Identifies PWM compare unit|
|PWM\_FAULT\_ID|Enum|Identifies PWM fault input ids|

-   **[PWMx\_Initialize Function](GUID-D422CB59-3E7E-4A20-A0DF-9DA89C35930A.md)**  

-   **[PWMx\_ChannelsStop Function](GUID-CA420B63-1280-4831-A077-AA2A7BC18C37.md)**  

-   **[PWMx\_ChannelsStart Function](GUID-956D2CC2-AC83-4A11-B426-1C66B81BD82A.md)**  

-   **[PWMx\_ChannelPeriodSet Function](GUID-C9FAD3AA-9842-4ECB-A376-D19DB099487A.md)**  

-   **[PWMx\_ChannelPeriodGet Function](GUID-25BA4898-0C0C-499C-88F0-00C0FB36E264.md)**  

-   **[PWMx\_ChannelDutySet Function](GUID-1E99241B-D462-4F6C-8FB7-BB452649033C.md)**  

-   **[PWMx\_ChannelCounterEventStatusGet Function](GUID-9DE5F9C2-F35A-4146-AE3B-C6DD69D9412B.md)**  

-   **[PWMx\_ChannelCounterEventEnable Function](GUID-F2CBF298-62EA-4247-AA80-542AEE8FE47C.md)**  

-   **[PWMx\_ChannelCounterEventDisable Function](GUID-EE38EB54-6E8F-4DC7-A17C-E63D7CCD1914.md)**  

-   **[PWMx\_CallbackRegister Function](GUID-9710228C-BB9B-4F14-8EF0-EE0E8A364036.md)**  

-   **[PWMx\_SyncUpdateEnable Function](GUID-2694BDFE-FD5A-4143-BB18-C34BC73AECAC.md)**  

-   **[PWMx\_FaultStatusClear Function](GUID-C4EB17D6-B765-4839-93B2-5380CC6BA7B2.md)**  

-   **[PWMx\_CompareValueSet Function](GUID-66EEC519-70D0-4E66-8647-061EAF8974CC.md)**  

-   **[PWMx\_ChannelOverrideEnable Function](GUID-7148F78E-B103-46BC-9BBE-77FB5579853E.md)**  

-   **[PWMx\_ChannelOverrideDisable Function](GUID-0DA348C7-A727-4152-A5F9-700AEAC86D4F.md)**  

-   **[PWMx\_ChannelDeadTimeSet Function](GUID-E22BAC10-942B-481B-ADC7-311729AA109C.md)**  

-   **[PWM\_FAULT\_ID Enum](GUID-ED593BB7-4241-4A94-B558-7A9EB4CA37F0.md)**  

-   **[PWM\_COMPARE Enum](GUID-FD516404-2DDD-4339-809F-C4B3E3DC3500.md)**  

-   **[PWM\_CHANNEL\_NUM Enum](GUID-68921292-DFB5-4EAD-8C00-3E53014F6C32.md)**  

-   **[PWM\_CHANNEL\_MASK Enum](GUID-4143081E-05B3-4FD2-B14E-65DB3B0A5DBC.md)**  

-   **[PWM\_CALLBACK Typedef](GUID-A4F84B32-EEC2-4510-B984-34E3D1860644.md)**  


**Parent topic:**[PIC32CX MT Peripheral Libraries](GUID-EEA7836F-956F-4526-BF85-CD488C4CE708.md)

**Parent topic:**[SAM A5D2 Peripheral Libraries](GUID-F6605EDC-FC71-4081-8560-0C1681C1FA8D.md)

**Parent topic:**[SAM A7G5 Peripheral Libraries](GUID-7EEB1AC5-4BFF-4259-97AD-8CF7367D7973.md)

**Parent topic:**[SAM E70 S70 V70 V71 Peripheral Libraries](GUID-6E45C146-6F6D-452A-A2E2-228C3CC905D7.md)

**Parent topic:**[SAM RH707 Peripheral Libraries](GUID-C2AC236D-363B-4378-A381-B281F67C8647.md)

**Parent topic:**[SAM RH71 Peripheral Libraries](GUID-AC9BE324-E486-46EA-8D16-E04E15288053.md)

