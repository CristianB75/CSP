<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Shutdown Controller (SHDWC)" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="shutdown-controller-shdwc" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Shutdown Controller (SHDWC)</title>
<meta name="Microsoft.Help.Id" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8-shutdown-controller-shdwc" />
<meta name="Microsoft.Help.TocParent" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Peripheral Libraries Reference A 09/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-D4DB3E69-9AEA-47F9-A76D-D123E7E252AA"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="shutdown-controller-shdwc">
<h1 class="title topictitle1" id="ariaid-title1">Shutdown Controller (SHDWC)</h1><div class="body"><p class="p">The Shutdown Controller asserts the SHUTDOWN output pin and performs wakeup detection on debounced input lines.</p>
<p class="p">It has the following Embedded Characteristics:</p>
<ul class="ul"><li class="li"><p class="p">Shutdown Logic</p>
<ul class="ul"><li class="li"><p class="p">Software Assertion of the Shutdown Output Pin (SHDN)</p>
</li>
<li class="li"><p class="p">Programmable deassertion from the PIOBU, WKUP Input Pins</p>
</li>
</ul>
</li>
<li class="li"><p class="p">Wakeup Logic</p>
<ul class="ul"><li class="li"><p class="p">Programmable Assertion from the PIOBU, WKUP Input Pins, and Internal Wakeup Event from RTC, RXLP, ACC, Security Module</p>
</li>
</ul>
</li>
</ul>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">Shutdown peripheral library can be used to:</p>
<ul class="ul"><li class="li"><p class="p">Configure the wakeup events for the MPU</p>
</li>
<li class="li"><p class="p">Software assert the SHDN signal to indicate that the MPU needs to be shutdown. A typical application connects the pin SHDN to the shutdown input of the DC/DC Converter providing the main power supplies of the system, and especially VDDCORE and/or VDDIO.</p>
</li>
<li class="li"><p class="p">Get the event that caused the MPU to wake up</p>
</li>
</ul>
<p class="p">The following program demonstrates assertion of the SHDN signal on pressing of a switch connected to the PIO.The program normally toggles an LED, and upon pressing the switch the SHDN signal is asserted. This signal,if connected to the external PMIC, would then be used to manage the power to the MPU.</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d642745e49', this);">Copy</button><code id="d642745e49" content="void switchHandler( PIO_PIN pin, uintptr_t context)&#xA;{&#xA;    SHDWC_Shutdown();&#xA;}&#xA;&#xA;int main ( void )&#xA;{&#xA;    /* Initialize all modules */&#xA;    SYS_Initialize ( NULL );&#xA;    PIO_PinInterruptCallbackRegister(SWITCH_PIN, switchHandler, 0);&#xA;    PIO_PinInterruptEnable(SWITCH_PIN);&#xA;&#xA;    while ( true )&#xA;    {&#xA;        PIT_DelayMs(500);&#xA;        LED_Toggle();&#xA;        /* Maintain state machines of all polled MPLAB Harmony modules. */&#xA;        SYS_Tasks ( );&#xA;    }&#xA;&#xA;    /* Execution should not come here during normal operation */&#xA;    return ( EXIT_FAILURE );&#xA;}"><span class="ph token keyword">void</span> <span class="ph token function">switchHandler</span><span class="ph token punctuation">(</span> PIO_PIN pin<span class="ph token punctuation">,</span> uintptr_t context<span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token function">SHDWC_Shutdown</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span>

<span class="ph token keyword">int</span> main <span class="ph token punctuation">(</span> <span class="ph token keyword">void</span> <span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token comment">/* Initialize all modules */</span>
    SYS_Initialize <span class="ph token punctuation">(</span> <span class="ph token constant">NULL</span> <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    <span class="ph token function">PIO_PinInterruptCallbackRegister</span><span class="ph token punctuation">(</span>SWITCH_PIN<span class="ph token punctuation">,</span> switchHandler<span class="ph token punctuation">,</span> <span class="ph token number">0</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    <span class="ph token function">PIO_PinInterruptEnable</span><span class="ph token punctuation">(</span>SWITCH_PIN<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

    <span class="ph token keyword">while</span> <span class="ph token punctuation">(</span> true <span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token function">PIT_DelayMs</span><span class="ph token punctuation">(</span><span class="ph token number">500</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
        <span class="ph token function">LED_Toggle</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
        <span class="ph token comment">/* Maintain state machines of all polled MPLAB Harmony modules. */</span>
        SYS_Tasks <span class="ph token punctuation">(</span> <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    <span class="ph token punctuation">}</span>

    <span class="ph token comment">/* Execution should not come here during normal operation */</span>
    <span class="ph token keyword">return</span> <span class="ph token punctuation">(</span> EXIT_FAILURE <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span></code></pre><p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Shutdown Controller peripheral library provides the following interfaces:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d642745e221"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d642745e223"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e221 "><span>SHDWC_Initialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e223 "><span>Initialize shutdown controller</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e221 "><span>SHDWC_Shutdown</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e223 "><span>Assert the shutdown signal</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e221 "><span>SHDWC_GetWakeup</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d642745e223 "><span>Read and clear the status register</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>