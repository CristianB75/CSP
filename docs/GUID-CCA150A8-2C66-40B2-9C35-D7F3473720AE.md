# Timer Counter for Control Applications \(TCC\)

Timer Counter for Control Applications \(TCC\) peripheral consists of counter, compare/capture channels and control logic. Waveform extensions are featured for motor control, ballast, LED, H-bridge, power converters, and other types of power control applications. They allow for low- and high-side output with optional dead-time insertion.

TCC provides below features:

-   Up to four compare/capture channels \(CC\) with double buffering

-   Waveform extensions:

-   Configurable distribution of compare channels outputs across port pins

-   Low- and high-side output with programmable dead-time insertion

-   Waveform swap option with double buffer support

-   Pattern generation with double buffer support

-   Dithering support

-   Fault protection for safe disabling of drivers

-   Two non-recoverable fault sources

-   Two recoverable fault sources


**Timer mode**

This section provides brief overview of the TC peripheral library in Timer mode

**Using The Library**

When the timer is enabled, it increments by one on every rising edge of the input clock, and generates an interrupt on a period match \(period is controlled by CC0 in MPWM waveform mode\). Timer mode is used for periodic interrupt generation. It provides both polling and callback methods to indicate period match has occurred. With polling, the application will need to continuously poll to check if the timer has expired. With callback, the registered callback function will be called when the timer expires. This means the application do not have to poll continuously.

**Library Interface**

Timer Counter for Control Applications peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|TCCx\_TimerInitialize|Initializes given instance of TCC|
|TCCx\_TimerStart|Starts the timer for given TCC instance|
|TCCx\_TimerStop|Stops the timer for given TCC instance|
|TCCx\_TimerFrequencyGet|Provides the given timer's counter-increment frequency|
|TCCx\_Timer24bitPeriodSet|Sets the period value of a given timer|
|TCCx\_Timer24bitPeriodGet|Reads the period value of given timer|
|TCCx\_Timer24bitCounterGet|Reads the timer current count value|
|TCCx\_Timer24bitCounterSet|Sets new timer counter value|
|TCCx\_Timer24bitCompareSet|Sets the compare value of a given timer channel|
|TCCx\_Timer16bitPeriodSet|Sets the period value of a given timer|
|TCCx\_Timer16bitPeriodGet|Reads the period value of given timer|
|TCCx\_Timer16bitCounterGet|Reads the timer current count value|
|TCCx\_Timer16bitCounterSet|Sets new timer counter value|
|TCCx\_Timer16bitCompareSet|Sets the compare value of a given timer channel|
|TCCx\_TimerCallbackRegister|Registers the function to be called from interrupt|
|TCCx\_TimerPeriodHasExpired|Checks whether timer period is elapsed|
|TCCx\_TimerCommandSet|Issues the command to TCC instance|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCC\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tcc callback function|

**Compare mode**

This section provides brief overview of the TC peripheral library in Compare mode.

**Using The Library**

When using the TC and the Compare/Capture Value registers \(CCx\) for compare operations, the counter value is continuously compared to the values in the CCx registers. The Channel x Compare Buffer \(CCBUFx\) registers provide double buffer capability. Output polarity can be reversed by inverting the output waveforms. In compare mode, overflow interrupt and compare match interrupts can be used to change the frequency or duty cycle of the waveform.

**Library Interface**

Timer Counter for Control Applications peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|TCCx\_CompareInitialize|Initializes given instance of TCC|
|TCCx\_CompareStart|Starts the timer for given TCC instance|
|TCCx\_CompareStop|Stops the timer for given TCC instance|
|TCCx\_CompareFrequencyGet|Provides the given timer's counter-increment frequency|
|TCCx\_Compare16bitPeriodSet|Sets the period value of a given timer|
|TCCx\_Compare16bitPeriodGet|Reads the period value of given timer|
|TCCx\_Compare16bitCounterGet|Reads the timer current count value|
|TCCx\_Compare16bitCounterSet|Sets new timer counter value|
|TCCx\_Compare16bitMatchSet|Writes compare value of the given compare channel|
|TCCx\_Compare24bitPeriodSet|Sets the period value of a given timer|
|TCCx\_Compare24bitPeriodGet|Reads the period value of given timer|
|TCCx\_Compare24bitCounterGet|Reads the timer current count value|
|TCCx\_Compare24bitCounterSet|Sets new timer counter value|
|TCCx\_Compare24bitMatchSet|Writes compare value of the given compare channel|
|TCCx\_CompareCallbackRegister|Registers the function to be called from interrupt|
|TCCx\_CompareStatusGet|Reads status of compare operation|
|TCCx\_CompareCommandSet|Issues the command to TCC instance|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCC\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tcc callback function|

**Capture mode**

This section provides brief overview of the TC peripheral library in Capture mode.

**Using The Library**

Capture trigger can be provided by

-   Input event line TC\_EV

-   Two event input line is available

-   This provides different capture event actions:

-   Pulse width in CC0 and period in CC1

-   Pulse width in CC1 and period in CC0

-   Pulse width

-   Input event line TC\_MCEIx

-   Each capture channel has associated input capture event line


It provides both polling and callback methods to indicate capture event has occurred.

-   With polling, the application will need to continuously poll to check if the capture event has occurred.

-   With callback, the registered callback function will be called when the capture event occurs. This means the application do not have to poll continuously.


**Library Interface**

Timer Counter for Control Applications peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|TCCx\_CaptureInitialize|Initializes given instance of TCC|
|TCCx\_CaptureStart|Starts the timer for given TCC instance|
|TCCx\_CaptureStop|Stops the timer for given TCC instance|
|TCCx\_CaptureFrequencyGet|Provides the given timer's counter-increment frequency|
|TCCx\_Capture16bitValueGet|Reads capture value from given channel|
|TCCx\_Capture16bitCounterGet|Reads the timer current count value|
|TCCx\_Capture24bitValueGet|Reads capture value from given channel|
|TCCx\_Capture24bitCounterGet|Reads the timer current count value|
|TCCx\_CaptureCommandSet|Issues the command to TCC instance|
|TCCx\_CaptureCallbackRegister|Registers the function to be called from interrupt|
|TCCx\_CaptureStatusGet|Reads status capture operation|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCC\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tcc callback function|
|TCCx\_CAPTURE\_STATUS|Enum|TCC capture status flags|

**PWM mode**

This section provides brief overview of the TC peripheral library in PWM mode.

**Using The Library**

TCC is used to generate single slope or dual slope PWM signals with dead time. This can generate four complimentary PWM signals.

Below example shows to generate 3 phase PWM signals for motor control<br />application. Duty cycle is updated in interrupt handler.

```

/* Duty cycle increment value */
\#define DUTY_INCREMENT (10U)

/* Save PWM period */
uint32_t period;

/* This function is called after TCC period event */
void TCC_PeriodEventHandler(uint32_t status, uintptr_t context)
{
    /* duty cycle values */
    static uint32_t duty1 = 0U;
    static uint32_t duty2 = 0U;
    static uint32_t duty3 = 0U;

    TCC0_PWM24bitDutySet(TCC0_CHANNEL1, duty1);
    TCC0_PWM24bitDutySet(TCC0_CHANNEL2, duty2);
    TCC0_PWM24bitDutySet(TCC0_CHANNEL3, duty3);

    /* Increment duty cycle values */
    duty1 += DUTY_INCREMENT;
    duty2 += DUTY_INCREMENT;
    duty3 += DUTY_INCREMENT;


    if (duty1 > period)
    {
            duty1 = 0U;
        if (duty2 > period)
            duty2 = 0U;
        if (duty3 > period)
            duty3 = 0U;
    }
}

int main ( void )
{
    /* Initialize all modules */
    SYS_Initialize ( NULL );

        /* Register callback function for period event */
    TCC0_PWMCallbackRegister(TCC_PeriodEventHandler, (uintptr_t)NULL);

    /* Read the period */
    period = TCC0_PWM24bitPeriodGet();

    /* Start PWM*/
    TCC0_PWMStart();

    while(1);
}
```

**Library Interface**

Timer Counter for Control Applications peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|TCCx\_PWMInitialize|Initializes given instance of TCC|
|TCCx\_PWMStart|Starts PWM generation of given TCC instance|
|TCCx\_PWMStop|Stops PWM generation of given TCC instance|
|TCCx\_PWMPatternSet|Sets the output PWM pattern|
|TCCx\_PWM24bitPeriodSet|Sets the period value of a given TCC instance|
|TCCx\_PWM24bitPeriodGet|Reads the period value of a given TCC instance|
|TCCx\_PWM24bitDutySet|Sets the duty value of a given TCC channel|
|TCCx\_PWM24bitCounterSet|Sets the counter value of a given TCC instance|
|TCCx\_PWM16bitPeriodSet|Sets the period value of a given TCC instance|
|TCCx\_PWM16bitPeriodGet|Reads the period value of a given TCC instance|
|TCCx\_PWM16bitDutySet|Sets the duty value of a given TCC channel|
|TCCx\_PWM16bitCounterSet|Sets the counter value of a given TCC instance|
|TCCx\_PWMDeadTimeSet|Sets the dead time of a given TCC module|
|TCCx\_PWMForceUpdate|Updates double buffer register value to actual register asynchronously|
|TCCx\_PWMPeriodInterruptEnable|Enables period interrupt|
|TCCx\_PWMPeriodInterruptDisable|Disables period interrupt|
|TCCx\_PWMInterruptStatusGet|Reads the interrupt flags|
|TCCx\_PWMCallbackRegister|Registers the function to be called from interrupt|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TCCx\_CHANNEL\_NUM|Enum|Identifies channel number within TCC module|
|TCC\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the tcc callback function|

-   **[TCCx\_TimerInitialize Function](GUID-6D144B55-FFB6-40C3-8849-D5EA70B0211B.md)**  

-   **[TCCx\_Timer16bitCompareSet Function](GUID-10F8B20E-4229-4597-82E6-47334A6CFF24.md)**  

-   **[TCCx\_Timer16bitCounterGet Function](GUID-AEC36B44-9261-4853-8170-D72B2B38F39B.md)**  

-   **[TCCx\_Timer16bitCounterSet Function](GUID-D1099AAF-556A-4AFE-B1A5-F24BD1310E50.md)**  

-   **[TCCx\_Timer16bitPeriodGet Function](GUID-96C65088-3F0C-4CA4-AB6E-7CF7A1DEB697.md)**  

-   **[TCCx\_Timer16bitPeriodSet Function](GUID-76B7F8FE-70AB-403E-A45A-964BC888D9F0.md)**  

-   **[TCCx\_Timer24bitCompareSet Function](GUID-F20DFEF6-FF05-4465-BB70-A4CBFC99B70D.md)**  

-   **[TCCx\_Timer24bitCounterGet Function](GUID-ED6CEFE2-150F-41BA-8A7F-E46FFEA42322.md)**  

-   **[TCCx\_Timer24bitCounterSet Function](GUID-4FA1CD9C-3182-4E8C-A808-A102F591DC80.md)**  

-   **[TCCx\_Timer24bitPeriodGet Function](GUID-AB52904A-D82F-4733-B13C-CE383B44112D.md)**  

-   **[TCCx\_Timer24bitPeriodSet Function](GUID-E3DD16DC-C8E4-4091-AB95-50E0C207CBD2.md)**  

-   **[TCCx\_TimerCallbackRegister Function](GUID-0961C522-67B9-4639-9349-8DF20701F17C.md)**  

-   **[TCCx\_TimerCommandSet Function](GUID-737645FE-3CB5-4E95-8C9B-F2568625C53E.md)**  

-   **[TCCx\_TimerFrequencyGet Function](GUID-BD7CD98E-F8B5-4D10-B307-4F0F14A152B8.md)**  

-   **[TCCx\_TimerPeriodHasExpired Function](GUID-AC01C1A0-57AC-4F98-B9EB-452AED021346.md)**  

-   **[TCCx\_TimerStart Function](GUID-7CFA22D2-7290-4602-9392-9BCA151D91F2.md)**  

-   **[TCCx\_TimerStop Function](GUID-C5CC760F-DC27-4CBF-A483-3E0A5684E29F.md)**  

-   **[TCCx\_CompareInitialize Function](GUID-DED19F98-2B8C-4E0A-9B7A-430D1574DDB9.md)**  

-   **[TCCx\_Compare16bitCounterGet Function](GUID-F9AF93DE-5B0F-44F9-B45D-4F0DFAC68E21.md)**  

-   **[TCCx\_Compare16bitCounterSet Function](GUID-C20BFB85-034F-4442-88A8-C9F38256A778.md)**  

-   **[TCCx\_Compare16bitMatchSet Function](GUID-D712F598-36B1-4EE2-B7E4-1F23214BFA79.md)**  

-   **[TCCx\_Compare16bitPeriodGet Function](GUID-6325C08B-9AD6-4312-A2D4-EE8ED2F8375A.md)**  

-   **[TCCx\_Compare16bitPeriodSet Function](GUID-13BA5533-8928-4468-BC02-3F15DB65CF73.md)**  

-   **[TCCx\_Compare24bitCounterGet Function](GUID-6EE0B8BE-1BE4-4170-B7B8-CC31F99ED951.md)**  

-   **[TCCx\_Compare24bitCounterSet Function](GUID-10CC61CA-11E6-460F-98ED-79A50B8B92CD.md)**  

-   **[TCCx\_Compare24bitMatchSet Function](GUID-DCE7155D-0B49-4A48-B887-ED758780A97D.md)**  

-   **[TCCx\_Compare24bitPeriodGet Function](GUID-20604466-1AB2-44C2-899A-D66C680C6CBB.md)**  

-   **[TCCx\_Compare24bitPeriodSet Function](GUID-E2DE6804-2333-4A14-9094-939C5338D9E3.md)**  

-   **[TCCx\_CompareCallbackRegister Function](GUID-702B5FC7-3359-4B94-A44B-99480E73613C.md)**  

-   **[TCCx\_CompareCommandSet Function](GUID-3495B70C-8A74-44C6-8099-F561843E71EF.md)**  

-   **[TCCx\_CompareFrequencyGet Function](GUID-2F9242F9-1BDF-46F7-A39C-4FDEBA9A42BC.md)**  

-   **[TCCx\_CompareStatusGet Function](GUID-BBC48000-9996-4608-91D8-833F22621505.md)**  

-   **[TCCx\_CompareStart Function](GUID-CCC091C7-5B06-49D9-A378-7F025C82CAD6.md)**  

-   **[TCCx\_CompareStop Function](GUID-116EA1DF-4643-472C-8603-E7758C2C670F.md)**  

-   **[TCCx\_Capture16bitCounterGet Function](GUID-B2BFBB0C-0474-431F-88F4-0C4E84346398.md)**  

-   **[TCCx\_Capture16bitValueGet Function](GUID-9A10D431-8F2F-4C61-9B50-B20CAB638272.md)**  

-   **[TCCx\_Capture24bitCounterGet Function](GUID-0AF5ABC7-7B2B-4F18-8926-E1619C64D548.md)**  

-   **[TCCx\_Capture24bitValueGet Function](GUID-8CFE9C09-FD2C-4DE6-B41C-AB96593FAC92.md)**  

-   **[TCCx\_CaptureCallbackRegister Function](GUID-31F920D0-ECB3-447C-BFF8-EE58A4396BB8.md)**  

-   **[TCC0\_CaptureCommandSet Function](GUID-A312ECE5-9D62-4A7A-8A04-B5FA9D0C7A45.md)**  

-   **[TCCx\_CaptureFrequencyGet Function](GUID-9442BB2C-2FDC-4F06-856B-6FE108916B6B.md)**  

-   **[TCCx\_CaptureInitialize Function](GUID-F7AE1813-EDB7-4159-9F2F-2CD0822B6A83.md)**  

-   **[TCCx\_CaptureStart Function](GUID-A3EC6707-FEA6-4025-8B79-BDA2B902A3E9.md)**  

-   **[TCCx\_CaptureStatusGet Function](GUID-4CB8263A-272F-4E1F-80D0-5A64B21B99EF.md)**  

-   **[TCCx\_CaptureStop Function](GUID-43FEA334-C007-4804-A965-EB331CC41789.md)**  

-   **[TCCx\_PWM16bitCounterSet Function](GUID-2CE0554F-DC49-4670-AD11-626F18B680C8.md)**  

-   **[TCCx\_PWM16bitDutySet Function](GUID-AE885AA3-3EF0-4FD0-9CE4-E9057C4E9C7B.md)**  

-   **[TCCx\_PWM16bitPeriodGet Function](GUID-6E3DF59C-8B24-4808-9B0E-A2EC8CDC3B46.md)**  

-   **[TCCx\_PWM16bitPeriodSet Function](GUID-62036A3B-3731-4CBE-B9A0-60DD47362D3B.md)**  

-   **[TCCx\_PWM24bitCounterSet Function](GUID-9F22147C-2A8C-4A6E-AB2A-D90D03AE3FDE.md)**  

-   **[TCCx\_PWM24bitDutySet Function](GUID-E2A049C2-5B15-4884-8D25-63A6260C46CE.md)**  

-   **[TCCx\_PWM24bitPeriodGet Function](GUID-4BD3584B-6F1D-4418-9C43-B0CBFD4B2663.md)**  

-   **[TCCx\_PWM24bitPeriodSet Function](GUID-A42DA5F1-EA23-4D68-BD5C-64B9CD59A070.md)**  

-   **[TCCx\_PWMCallbackRegister Function](GUID-C94FBA3A-5EEB-4A5A-9842-23454DE93D54.md)**  

-   **[TCCx\_PWMDeadTimeSet Function](GUID-F41D4CFB-CCB3-42DA-A4B6-6B1039BBBF58.md)**  

-   **[TCCx\_PWMForceUpdate Function](GUID-99614BC8-01E3-4B14-9770-B9977E7CBFDA.md)**  

-   **[TCCx\_PWMInitialize Function](GUID-974F1CF9-7A13-4209-860B-3F84EFA415F5.md)**  

-   **[TCCx\_PWMInterruptStatusGet Function](GUID-034A8054-7761-40E6-9ABD-CD7FF1A1C7A5.md)**  

-   **[TCCx\_PWMPatternSet Function](GUID-39271329-201D-4A62-A1B3-04BEE4E67299.md)**  

-   **[TCCx\_PWMPeriodInterruptDisable Function](GUID-8301BADE-C25B-4418-AA9A-39FB33BC63D9.md)**  

-   **[TCCx\_PWMPeriodInterruptEnable Function](GUID-CAD55BCF-63F9-47E7-A59B-CEFE0AD339E7.md)**  

-   **[TCCx\_PWMStart Function](GUID-1F322FC5-7449-42C5-A80B-3ACD1BF2B8AD.md)**  

-   **[TCCx\_PWMStop Function](GUID-3A8D7A6D-6835-46A9-A225-C9E329548811.md)**  

-   **[TCC\_CALLBACK Typedef](GUID-588B29BA-04A7-432A-988D-255DF43F10B7.md)**  

-   **[TCCx\_CAPTURE\_STATUS Enum](GUID-4FD79D5E-486D-4457-9B6F-410728CFA808.md)**  

-   **[TCCx\_CHANNEL\_NUM Enum](GUID-332EE559-36A5-4BCE-85FC-5FEC9278734E.md)**  


**Parent topic:**[PIC32CM JH00 JH01 Peripheral Libraries](GUID-05924E45-D6B3-4F33-A5EA-9B080FC421D8.md)

**Parent topic:**[PIC32CM LE00 LS00 LS60 Peripheral Libraries](GUID-F80F1B47-C3E4-4803-ACB6-D30AC5EB7B45.md)

**Parent topic:**[PIC32CM MC00 Peripheral Libraries](GUID-ADF45DC0-B32C-4D1F-9332-59EC0DF5097E.md)

**Parent topic:**[PIC32CX BZ2 WBZ45 Peripheral Libraries](GUID-3D519D00-FDEE-4A3E-9EF7-20F335E64CEE.md)

**Parent topic:**[PIC32CX BZ3 WBZ3 Peripheral Libraries](GUID-5752DD6D-6E5D-484D-B564-DA87788492F3.md)

**Parent topic:**[SAM C20 C21 Peripheral Libraries](GUID-49072E61-B7F2-4B32-952E-D6F5FB361AFB.md)

**Parent topic:**[SAM D09 D10 D11 Peripheral Libraries](GUID-F4788319-C5F3-4EB3-8CC7-05770A2EBD32.md)

**Parent topic:**[SAM D20 D21 Peripheral Libraries](GUID-86A69A90-EDAB-465F-A03A-57CD8BF54AE8.md)

**Parent topic:**[SAM DA1 Peripheral Libraries](GUID-0CDE5F35-9BE3-4484-8299-98161C496C00.md)

**Parent topic:**[SAM HA1 Peripheral Libraries](GUID-7E583BB3-CBFA-4862-8ED5-40D747167457.md)

**Parent topic:**[SAM L22 Peripheral Libraries](GUID-C3997EBF-87A0-4DD9-BCB0-C8A58B62E44B.md)

