# Supply Controller \(SUPC\)

The Supply Controller \(SUPC\) manages the voltage reference, power<br />supply and supply monitoring of the device. It is also able to control<br />two output pins.

The SUPC controls the voltage regulators for the core \(VDDCORE\) and<br />backup \(VDDBU\) domains. It sets the voltage regulators according to the<br />sleep modes, or the user configuration.

The SUPC embeds two Brown-Out Detectors. BOD33 monitors the voltage<br />applied to the device \(VDD or VBAT\) and BOD12 monitors the internal<br />voltage to the core \(VDDCORE\). The BOD33 can monitor the supply voltage<br />continuously \(continuous mode\) or periodically \(sampling mode\), in<br />normal or low power mode.

**Using The Library**

The Brown-Out Detector \(BOD33\) when enabled, monitors the VDD supply<br />and compares the voltage with the brown-out threshold level. When VDD<br />crosses the brown-out threshold level, the BOD33 can perform one of the<br />following actions,

-   Generate a reset

-   Generates an interrupt

-   Puts the device in battery backup sleep mode


The triggering voltage threshold for the BOD33 and the action can be<br />configured via fuse bits in the NVM User Row. These bits can also be<br />written after disabling BOD33. Brown out interrupt enables user to save<br />critical data to prepare the system for a power-down.

SUPC Peripheral library provides non-Blocking API's and they can be<br />used to perform below functionalities. Settings configured via MHC are<br />written into SUPC registers when initialization function is called.

-   Initialize BOD33, VREF and VREG of the SUPC peripheral.

-   Set or clear OUTx pins of the SUPC peripheral.


**Callback method**

This example demonstrates how to get callback on brown-out detection to<br />save critical work.

```c
MY_APP_OBJ myAppObj;

void BOD_EventHandler(uintptr_t context)
{
    // The context was set to an application specific object.
    // It is now retrievable easily in the event handler.
    MY_APP_OBJ myAppObj = (MY_APP_OBJ *) context;

    // Brown-out interrupt occurred. Save critical data.
}

int main(void)
{
    /* Register callback function */
    SUPC_CallbackRegister(BOD_EventHandler, (uintptr_t)&myAppObj);

    while(true)
    {

    }
}
```

**Library Interface**

Supply Controller peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|SUPC\_Initialize|Initializes the SUPC peripheral|
|SUPC\_SetOutputPin|Sets a specific output pin \(OUTx\) to logic HIGH|
|SUPC\_ClearOutputPin|Clears a specific output pin \(OUTx\) to logic LOW|
|SUPC\_CallbackRegister|Registers the function to be called when a Brown Out Event has occurred|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|SUPC\_OUTPIN|Enum|Identifies the output pins of SUPC peripheral|
|SUPC\_CALLBACK|Typedef|Defines the data type and function signature for the SUPC peripheral callback function|

-   **[SUPC\_Initialize Function](GUID-D18356A1-3487-41FC-A6AA-5E425483A02C.md)**  

-   **[SUPC\_SetOutputPin Function](GUID-CDB719FA-2ED6-4A8E-A955-92DF1DBB1706.md)**  

-   **[SUPC\_ClearOutputPin Function](GUID-8F52D2BD-6421-4FF7-A4FD-D908E4C4F686.md)**  

-   **[SUPC\_CallbackRegister Function](GUID-9DDB551B-8196-4BD4-8E80-9F9FD071D4A1.md)**  

-   **[SUPC\_OUTPIN Enum](GUID-140606A3-FD67-4ED2-9726-4BBA4755F5D2.md)**  

-   **[SUPC\_CALLBACK Typedef](GUID-4EE9E59D-17BD-485D-8EEA-8B7B0827BAE2.md)**  


**Parent topic:**[PIC32CZ-CA Peripheral Libraries](GUID-7EAC3718-3D58-4007-AB2A-A0E3C167A2DF.md)

