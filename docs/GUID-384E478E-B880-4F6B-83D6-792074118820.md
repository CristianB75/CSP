# Two-wire Interface - TWI

The TWI PLIB can be configured in TWI master mode.

**TWI master mode**<br />The TWI peripheral library supports the following transfers:

Master Write: The master writes a block of data to the slave<br />Master Read: The master reads a block of data from the slave<br />Master Write/Read: The master writes and then reads back a block of data from slave.

The block of data is transferred in a non-blocking manner using a peripheral interrupt. Application can either use a callback or IsBusy API to check for completion of data transfer.

```c
// Following code demonstrates TWI write operation using polling method

#define APP_SLAVE_ADDR 0x0057
#define NUM_BYTES      10

uint8_t myWriteData [NUM_BYTES] = {'1', '0', ' ', 'B', 'Y', 'T', 'E', 'S', '!', '!',};

int main(void)
{
	/* Initialize all modules */
    SYS_Initialize ( NULL );
	
    /* Write data to the TWI Slave */
    TWI1_Write(APP_SLAVE_ADDR, &myWriteData[0], NUM_BYTES);

    /* Poll and wait for the transfer to complete */
    while(TWI1_IsBusy());

    /* Check if any error occurred */
    if(TWI1_ErrorGet() == TWI_ERROR_NONE)
    {
        //Transfer is completed successfully
    }
    else
    {
        //Error occurred during transfer.
    }
	...
}
```

```c
// Following code demonstrates TWI write operation using callback method

#define APP_SLAVE_ADDR 0x0057
#define NUM_BYTES      10

uint8_t myWriteData [NUM_BYTES] = {'1', '0', ' ', 'B', 'Y', 'T', 'E', 'S', '!', '!',};

void TWI1_Callback(uintptr_t context)
{
    if(TWI1_ErrorGet() == TWI_ERROR_NONE)
    {
        //Transfer is completed successfully
    }
    else
    {
        //Error occurred during transfer.
    }
}

int main(void)
{
	/* Initialize all modules */
    SYS_Initialize ( NULL );
	
    /* Register Callback function */
    TWI1_CallbackRegister(TWI1_Callback, (uintptr_t)NULL);

    /* Submit Write Request */
    TWI1_Write(APP_SLAVE_ADDR, &myWriteData[0], NUM_BYTES);
	
	...
}
```

**Library Interface**

**TWI Mode**

**Functions**

|Name|Description|
|----|-----------|
|TWIx\_Initialize|Initializes given instance of the TWI peripheral|
|TWIx\_Read|Reads data from the TWI slave|
|TWIx\_Write|Writes data to the TWI slave|
|TWIx\_WriteRead|Write and Read data from TWI Slave|
|TWIx\_IsBusy|Returns the TWI Peripheral busy status|
|TWIx\_ErrorGet|Returns the TWI error that occurred on the bus|
|TWIx\_TransferSetup|Dynamic setup of TWI Peripheral|
|TWIx\_CallbackRegister|Sets the pointer to the function \(and it's context\) to be called when the given TWI's transfer events occur|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TWI\_ERROR|Enum|Defines the possible errors that the I2C peripheral can generate in I2C master mode|
|TWI\_TRANSFER\_SETUP|Struct|I2C transfer setup data structure|
|TWI\_CALLBACK|Typedef|Defines the data type and function signature for the TWI peripheral callback function in TWI master mode|

-   **[TWIx\_WriteRead Function](GUID-316C353F-340D-41E5-8A35-944264581AB5.md)**  

-   **[TWIx\_Write Function](GUID-A48B5E78-C7EE-40F8-8625-B9D0A881F0CA.md)**  

-   **[TWIx\_TransferSetup Function](GUID-A7E04282-7532-46D7-9059-1D1A5FEFF26D.md)**  

-   **[TWIx\_Read Function](GUID-BA715027-0400-493C-BB9A-52108E1424F2.md)**  

-   **[TWIx\_IsBusy Function](GUID-676135D4-6406-4C8B-9CCD-C1C3B8B92BE7.md)**  

-   **[TWIx\_Initialize Function](GUID-7183ED8B-C0CB-4ADB-9470-83F0DB2ED5DA.md)**  

-   **[TWIx\_ErrorGet Function](GUID-5EFF2554-DCE8-48F2-BE3C-97E39120B915.md)**  

-   **[TWIx\_CallbackRegister Function](GUID-D55219E8-7428-4515-AFAC-7DEFB8BD883D.md)**  

-   **[TWI\_TRANSFER\_SETUP Struct](GUID-DF279CC2-A996-4445-8F75-5BA7F714FBA4.md)**  

-   **[TWI\_ERROR Enum](GUID-37A49F15-3AB6-4B96-8C9C-3292FAE38678.md)**  

-   **[TWI\_CALLBACK Typedef](GUID-CA64DCAB-14D9-4F6E-A5E6-FC4D96F92C44.md)**  


**Parent topic:**[SAM G51 G53 G54 Peripheral Libraries](GUID-E97B8116-033B-411A-925B-E8E6252A1E15.md)

