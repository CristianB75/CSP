# Timer\(TMR\)

Depending on the specific variant, the PIC32M device family offers several 16-bit timers. These timers are designated as Timer1, Timer2, Timer3, ..., etc.<br />Timers are useful for generating accurate time-based periodic interrupt events for software applications or real-time operating systems. Other uses include counting external pulses or accurate timing measurement of external events by using the timer's gate feature. With certain exceptions, all of the timers have the same functional circuitry.

The PIC32 has two kinds of timers:

**Timer1**

All timers can run when the Central Processing Unit \(CPU\) is in idle mode, but only Timer1's asynchronous external clock mode enables it to run while the CPU is in sleep. This, combined with its ability to be driven by a secondary oscillator, allows the timer to function as a real-time clock \(RTC\).

**Timer2, 3, 4, etc ...**

*This peripheral library covers timers of this category.*

Each timer has its own 16-bit counter and period registers. A 32-bit timer can be created by combining two timers \(e.g. Timer2 & Timer3\). In this case, the 32-bit timer is controlled by the even number timer control registers \(e.g. Timer2\). When an interrupt event occurs, the odd number timer generates the event \(e.g. Timer3\). The timer supports the following features.<br />16-bit and 32-bit modes<br />Synchronous Internal Timer<br />Synchronous Internal Gated Timer<br />Synchronous External Timer

**Timer Operation \(non-gate mode\)**<br />When a timer is not in gate mode, it will generate an interrupt event when the value in the counter matches the value in the period register. When this match occurs, the counter is reset to zero, and the timer starts counting again. Note that if interrupts are disabled, the timer interrupt flag, TxIF, will still be set.

**Timer Operation \(Gate mode\)**<br />You can use the timer's gate feature to accurately measure the time for an external event. When the timers are in gate mode, the counters \(driven by an internal clock\) only increment when the TxCK pin is high. When this pin goes low, the timer stops incrementing and the timer interrupt flag, TxIF, is set. Note that in this mode, an interrupt event is not generated when the timer value matches the period register.

**Using The Library**

Timer mode is used for periodic interrupt generation. When the timer is enabled, it increments by one on every rising edge of the input clock, and generates an interrupt on a period match and the registered callback function will be called.

**Callback method**<br />This example demonstrates how to use the timer to generate periodic callback.

```c
/* This function is called after period expires */
void TIMER2_EventHandler(uint32_t status, uintptr_t context)
{
    /* Toggle LED */
    LED_Toggle();
}

int main(void)
{
    /* Register callback function Timer interrupt */
    TMR2_CallbackRegister(TIMER2_EventHandler,(uintptr_t)NULL);

    /* Start the timer channel 0*/
    TMR2_Start();
}
```

**Library Interface**

peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|void||
|TMRx\_Initialize|Initializes given instance of TMR|
|TMRx\_Start|Starts the given Timer|
|TMRx\_Stop|Stops the given Timer counter|
|TMRx\_PeriodSet|Sets the period value of a given timer|
|TMRx\_PeriodGet|Reads the period value of given timer|
|TMRx\_CounterGet|Reads the timer counter value|
|TMRx\_FrequencyGet|Provides the given timer's counter-increment frequency|
|TMRx\_InterruptEnable|Enable TMR overflow interrupt|
|TMRx\_InterruptDisable|Disable TMR overflow interrupt|
|TMRx\_CallbackRegister|Sets the callback\_fn function for an match|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|TMR\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the TMRx callback function|

-   **[TMRx\_Initialize Function](GUID-CEE776BF-1147-4BB3-B996-6C55C4554D5C.md)**  

-   **[TMRx\_CallbackRegister Function](GUID-8C631290-DFDC-45EE-906D-CAD7C3DCDD61.md)**  

-   **[TMRx\_CounterGet Function](GUID-D95F0DE8-BFF1-45AA-AC41-71325CBE7248.md)**  

-   **[TMRx\_FrequencyGet Function](GUID-4AF977C9-7081-4815-A308-C550EB9CE2C2.md)**  

-   **[TMRx\_InterruptDisable Function](GUID-01A361B2-2BF2-4A5D-AACF-C2A4BD541FCD.md)**  

-   **[TMRx\_InterruptEnable Function](GUID-4E245EA7-A502-4249-A10E-0ED1EA360989.md)**  

-   **[TMRx\_PeriodGet Function](GUID-99C4D9F3-48D8-4480-92AC-598F8068DE48.md)**  

-   **[TMRx\_PeriodSet Function](GUID-6C61E70B-FEDF-446F-BFD2-8E92BF82F3C0.md)**  

-   **[TMRx\_Start Function](GUID-ED0D38C0-53DD-4B17-8207-DD9DE50EEA6D.md)**  

-   **[TMRx\_Stop Function](GUID-927E0F31-168F-4E4B-B6F1-4B53F92F68CE.md)**  

-   **[TMR\_CALLBACK Typedef](GUID-66DD3ED9-980C-4ABA-92C5-C583B1BC8F2C.md)**  


**Parent topic:**[PIC32MM GPL Peripheral Libraries](GUID-1AE2B428-AA57-43A7-A52E-C35ABF67EDC4.md)

**Parent topic:**[PIC32MM GPM Peripheral Libraries](GUID-CB22E113-2DFF-40FB-BA9B-BFA1C8003FEC.md)

**Parent topic:**[PIC32MX 1XX 2XX Peripheral Libraries](GUID-DD9F92A3-1B1F-4068-A4CC-C71672A1BF54.md)

**Parent topic:**[PIC32MX 1XX 2XX XLP Peripheral Libraries](GUID-8819552A-CB58-4DAC-BE25-EC305892232E.md)

**Parent topic:**[PIC32MX 1XX 2XX 5XX Peripheral Libraries](GUID-232A3DC0-B096-45AA-9430-33A2C9BA694A.md)

**Parent topic:**[PIC32MX 330 350 370 430 450 470 Peripheral Libraries](GUID-4F5C226F-136E-4C6B-8A7F-0DF12557C7F8.md)

**Parent topic:**[PIC32MX 3XX 4XX Peripheral Libraries](GUID-2C79235F-A27F-4622-BBDA-943C35FD7940.md)

**Parent topic:**[PIC32MX 5XX 6XX 7XX Peripheral Libraries](GUID-91DC3697-58A9-4E5B-95DE-F4B08BA9C8DD.md)

**Parent topic:**[PIC32MZ DA Peripheral Libraries](GUID-02A4B196-FE06-48DB-BC12-D3A68B6D983E.md)

**Parent topic:**[PIC32MZ EF Peripheral Libraries](GUID-F47955F5-89DE-43B0-8C2C-DE0070EBA152.md)

**Parent topic:**[PIC32MZ W1 Peripheral Libraries](GUID-EBD28D67-7F6E-46D1-9ABE-2BDE1973D143.md)

