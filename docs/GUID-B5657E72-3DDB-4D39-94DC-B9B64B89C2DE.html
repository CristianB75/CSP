<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Real-time Clock (RTC)" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="real-time-clock-rtc" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Real-time Clock (RTC)</title>
<meta name="Microsoft.Help.Id" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8-real-time-clock-rtc" />
<meta name="Microsoft.Help.TocParent" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Peripheral Libraries Reference A 09/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-B5657E72-3DDB-4D39-94DC-B9B64B89C2DE"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="real-time-clock-rtc">
<h1 class="title topictitle1" id="ariaid-title1">Real-time Clock (RTC)</h1><div class="body"><p class="p">The RTC provides a full binary-coded decimal (BCD) clock that includes century (19/20), year (with leap years), month, day, hours, minutes, and seconds. The RTC can operate in 24-hour mode or in 12-hour mode with an AM/PM indicator. The reference clock is the Slow Clock (SLCK) which can be driven internally or by an external 32.768 kHz crystal.</p>
<p class="p">The RTC continues to run in the device's low-power sleep modes, to track the current time and date information. The RTC can be used as a source to wake up the system at a scheduled time or periodically using the alarm functions.</p>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">The RTC keeps track of the current time and generates an alarm at the desired time. The RTC Alarm has five programmable fields: month, day, hours, minutes, and seconds.</p>
<p class="p">Each of these fields can be enabled or disabled individually to match the alarm condition:</p>
<ul class="ul"><li class="li"><p class="p">If all the fields are enabled, an alarm flag is generated (the corresponding flag is asserted and an interrupt generated if enabled) at a given month, date, hour, minute, and second</p>
</li>
<li class="li"><p class="p">If only the "seconds" field is enabled, then an alarm is generated every minute</p>
</li>
</ul>
<p class="p">Depending on the combination of fields enabled, a large number of possibilities are available to the user application ranging from minutes to 365/366 days.</p>
<p class="p">To avoid unwanted side effects, verification is performed on century, year, month, day, hours, minutes and seconds when the user sets up the time and alarm. If any field fails its check, the new data is not loaded into the destination register (or counter) and returns a "false" status. When the user programs acceptable time/date fields, the time set and alarm set API returns "true".</p>
<p class="p">This example demonstrates how to set the RTC time, and alarm time to
generate an alarm interrupt at the desired time of the day.</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d478358e34', this);">Copy</button><code id="d478358e34" content="void RTC0_Callback( uintptr_t context, uint32_t int_cause )&#xA;{&#xA;    if (int_cause &amp;amp; RTC_INT_ALARM)&#xA;    {&#xA;        /* Alarm has Occurred */&#xA;    }&#xA;}&#xA;&#xA;int main ( void )&#xA;{&#xA;    /* Initialize System Time and Alarm Time */&#xA;    struct tm sys_time;&#xA;    struct tm alarm_time;&#xA;&#xA;    /* Register Callback */&#xA;    RTC0_CallbackRegister(RTC0_Callback, (uintptr_t) NULL);&#xA;&#xA;&#xA;    /* Set Time and date&#xA;      &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:00 Monday&lt;/b&gt; */&#xA;    sys_time.tm_hour = 12;&#xA;    sys_time.tm_sec = 00;&#xA;    sys_time.tm_min = 00;&#xA;    sys_time.tm_mon = 0;&#xA;    sys_time.tm_year = 118;&#xA;    sys_time.tm_mday = 15;&#xA;    sys_time.tm_wday = 1;&#xA;&#xA;    if (RTC0_TimeSet(&amp;amp;sys_time) == false)&#xA;    {&#xA;        // Invalid time and/or data input&#xA;    }&#xA;&#xA;    /* Set Alarm Time and date. Generate alarm every day when Hour, Minute and Seconds match.&#xA;       &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:20 Monday&lt;/b&gt; */&#xA;    alarm_time.tm_hour = 12;&#xA;    alarm_time.tm_sec = 20;&#xA;    alarm_time.tm_min = 00;&#xA;    alarm_time.tm_mon = 0;&#xA;    alarm_time.tm_year = 118;&#xA;    alarm_time.tm_mday = 15;&#xA;    alarm_time.tm_wday = 1;&#xA;&#xA;    if (RTC0_AlarmSet(&amp;amp;alarm_time, RTC_ALARM_MASK_HHMISS) == false)&#xA;    {&#xA;        // Invalid Alarm Time and/or data input&#xA;    }&#xA;&#xA;    /* Get System Time */&#xA;    while ( true )&#xA;    {&#xA;        RTC0_TimeGet(&amp;amp;sys_time);&#xA;        printf(&#34;System time is:   %02d:%02d:%02d\\r&#34;,sys_time.tm_hour, sys_time.tm_min, sys_time.tm_sec);&#xA;    }&#xA;&#xA;}"><span class="ph token keyword">void</span> <span class="ph token function">RTC0_Callback</span><span class="ph token punctuation">(</span> uintptr_t context<span class="ph token punctuation">,</span> uint32_t int_cause <span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token keyword">if</span> <span class="ph token punctuation">(</span>int_cause <span class="ph token operator">&amp;</span> RTC_INT_ALARM<span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token comment">/* Alarm has Occurred */</span>
    <span class="ph token punctuation">}</span>
<span class="ph token punctuation">}</span>

<span class="ph token keyword">int</span> main <span class="ph token punctuation">(</span> <span class="ph token keyword">void</span> <span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token comment">/* Initialize System Time and Alarm Time */</span>
    <span class="ph token keyword">struct</span> <span class="ph token class-name">tm</span> sys_time<span class="ph token punctuation">;</span>
    <span class="ph token keyword">struct</span> <span class="ph token class-name">tm</span> alarm_time<span class="ph token punctuation">;</span>

    <span class="ph token comment">/* Register Callback */</span>
    <span class="ph token function">RTC0_CallbackRegister</span><span class="ph token punctuation">(</span>RTC0_Callback<span class="ph token punctuation">,</span> <span class="ph token punctuation">(</span>uintptr_t<span class="ph token punctuation">)</span> <span class="ph token constant">NULL</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>


    <span class="ph token comment">/* Set Time and date
      &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:00 Monday&lt;/b&gt; */</span>
    sys_time<span class="ph token punctuation">.</span>tm_hour <span class="ph token operator">=</span> <span class="ph token number">12</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_sec <span class="ph token operator">=</span> <span class="ph token number">00</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_min <span class="ph token operator">=</span> <span class="ph token number">00</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_mon <span class="ph token operator">=</span> <span class="ph token number">0</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_year <span class="ph token operator">=</span> <span class="ph token number">118</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_mday <span class="ph token operator">=</span> <span class="ph token number">15</span><span class="ph token punctuation">;</span>
    sys_time<span class="ph token punctuation">.</span>tm_wday <span class="ph token operator">=</span> <span class="ph token number">1</span><span class="ph token punctuation">;</span>

    <span class="ph token keyword">if</span> <span class="ph token punctuation">(</span><span class="ph token function">RTC0_TimeSet</span><span class="ph token punctuation">(</span><span class="ph token operator">&amp;</span>sys_time<span class="ph token punctuation">)</span> <span class="ph token operator">==</span> false<span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token comment">// Invalid time and/or data input</span>
    <span class="ph token punctuation">}</span>

    <span class="ph token comment">/* Set Alarm Time and date. Generate alarm every day when Hour, Minute and Seconds match.
       &lt;b&gt;15&amp;#45;01&amp;#45;2018 12:00:20 Monday&lt;/b&gt; */</span>
    alarm_time<span class="ph token punctuation">.</span>tm_hour <span class="ph token operator">=</span> <span class="ph token number">12</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_sec <span class="ph token operator">=</span> <span class="ph token number">20</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_min <span class="ph token operator">=</span> <span class="ph token number">00</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_mon <span class="ph token operator">=</span> <span class="ph token number">0</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_year <span class="ph token operator">=</span> <span class="ph token number">118</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_mday <span class="ph token operator">=</span> <span class="ph token number">15</span><span class="ph token punctuation">;</span>
    alarm_time<span class="ph token punctuation">.</span>tm_wday <span class="ph token operator">=</span> <span class="ph token number">1</span><span class="ph token punctuation">;</span>

    <span class="ph token keyword">if</span> <span class="ph token punctuation">(</span><span class="ph token function">RTC0_AlarmSet</span><span class="ph token punctuation">(</span><span class="ph token operator">&amp;</span>alarm_time<span class="ph token punctuation">,</span> RTC_ALARM_MASK_HHMISS<span class="ph token punctuation">)</span> <span class="ph token operator">==</span> false<span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token comment">// Invalid Alarm Time and/or data input</span>
    <span class="ph token punctuation">}</span>

    <span class="ph token comment">/* Get System Time */</span>
    <span class="ph token keyword">while</span> <span class="ph token punctuation">(</span> true <span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token function">RTC0_TimeGet</span><span class="ph token punctuation">(</span><span class="ph token operator">&amp;</span>sys_time<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
        <span class="ph token function">printf</span><span class="ph token punctuation">(</span><span class="ph token string">"System time is:   %02d:%02d:%02d\\r"</span><span class="ph token punctuation">,</span>sys_time<span class="ph token punctuation">.</span>tm_hour<span class="ph token punctuation">,</span> sys_time<span class="ph token punctuation">.</span>tm_min<span class="ph token punctuation">,</span> sys_time<span class="ph token punctuation">.</span>tm_sec<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    <span class="ph token punctuation">}</span>

<span class="ph token punctuation">}</span></code></pre><p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Real-time Clock peripheral library provides the following interfaces:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d478358e468"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d478358e470"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_Initialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Initializes given instance of the RTC peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_TimeSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Sets the Time for the RTC peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_TimeGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Reads the current time</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_AlarmSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Sets up the Alarm</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_InterruptDisable</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Disables the specified RTC interrupt</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_InterruptEnable</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Enables the specified RTC interrupt</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e468 "><span>RTC_CallbackRegister</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e470 "><span>Sets the pointer to the function (and it's context) to be called when the Timeout events occur</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Data types and constants</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d478358e518"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d478358e520"><span>Type</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d478358e522"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e518 "><span>RTC_ALARM_MASK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e520 "><span>Enum</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e522 "><span>Defines the data type for the RTC Alarm Mask</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e518 "><span>RTC_INT_MASK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e520 "><span>Enum</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e522 "><span>Defines the Interrupt mask for RTC events</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e518 "><span>RTC_CALLBACK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e520 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d478358e522 "><span>Defines the data type and function signature for the RTC peripheral callback function</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>