# Pulse Width Modulation Controller \(PWM\)

The Pulse Width Modulation Controller \(PWM\) controls several channels independently. Each channel controls one square output waveform. Characteristics of the output waveform such as period, duty-cycle and polarity are configurable through the user interface. Each channel selects and uses one of the clocks provided by the clock generator. The clock generator provides several clocks resulting from the division of the PWM macrocell master clock. Channels can be synchronized, to generate non overlapped waveforms. All channels integrate a double buffering system in order to prevent an unexpected output waveform while modifying the period or the duty-cycle.

**Using The Library**

This example shows how to configure the PWM to generate three PWM waveform signals. The duty cycle of the PWM is updated in the interrupt handler.

```c
/* Duty cycle increment value */
#define DUTY_INCREMENT (10U)

/* Save PWM period */
uint32_t period;

/* This function is called after PWM0 counter event */
void PWM_CounterEventHandler(uintptr_t context)
{
    static uint32_t duty0 = 0U;
    static uint32_t duty1 = 2500U;
    static uint32_t duty2 = 5000U;

    PWM0_ChannelDutySet(PWM_CHANNEL_0, duty0);
    PWM0_ChannelDutySet(PWM_CHANNEL_1, duty1);
    PWM0_ChannelDutySet(PWM_CHANNEL_2, duty2);

    /* Increment duty cycle values */
    duty0 += DUTY_INCREMENT;
    duty1 += DUTY_INCREMENT;
    duty2 += DUTY_INCREMENT;

    if (duty0 > period)
        duty0 = 0U;
    if (duty1 > period)
        duty1 = 0U;
    if (duty2 > period)
        duty2 = 0U;
}

int main ( void )
{
    /* Register callback function for Channel 0 counter event */
    PWM0_CallbackRegister(PWM_CounterEventHandler, (uintptr_t)NULL);

    /* Read the period */
    period = PWM0_ChannelPeriodGet(PWM_CHANNEL_0);

    /* Start all channels synchronously */
    PWM0_ChannelsStart(PWM_CHANNEL_0_MASK | PWM_CHANNEL_1_MASK | PWM_CHANNEL_2_MASK);
}
```

**Library Interface**

Pulse Width Modulation Controller peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|PWMx\_Initialize|Initializes given instance of PWM peripheral|
|PWMx\_ChannelsStart|Starts the given PWM channels|
|PWMx\_ChannelsStop|Stops the given PWM channels|
|PWMx\_ChannelPeriodSet|Sets the period value of given PWM channel|
|PWMx\_ChannelPeriodGet|Reads the period value of given PWM channel|
|PWMx\_ChannelDutySet|Writes the duty cycle value of given PWM channel|
|PWMx\_ChannelCounterEventEnable|Enables counter event of given channels|
|PWMx\_ChannelCounterEventDisable|Disables counter event of given channels|
|PWMx\_ChannelCounterEventStatusGet|Disables counter event of given channels|
|PWMx\_CallbackRegister|Registers the function to be called from interrupt|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|PWM\_CALLBACK|Typedef|Defines the data type and function signature for the PWM peripheral callback function|
|PWM\_CHANNEL\_NUM|Enum|Identifies PWM channel number in a PWM peripheral|
|PWM\_CHANNEL\_MASK|Enum|Identifies PWM channel mask|

-   **[PWMx\_Initialize Function](GUID-D422CB59-3E7E-4A20-A0DF-9DA89C35930A.md)**  

-   **[PWMx\_ChannelsStop Function](GUID-CA420B63-1280-4831-A077-AA2A7BC18C37.md)**  

-   **[PWMx\_ChannelsStart Function](GUID-956D2CC2-AC83-4A11-B426-1C66B81BD82A.md)**  

-   **[PWMx\_ChannelPeriodSet Function](GUID-C9FAD3AA-9842-4ECB-A376-D19DB099487A.md)**  

-   **[PWMx\_ChannelPeriodGet Function](GUID-25BA4898-0C0C-499C-88F0-00C0FB36E264.md)**  

-   **[PWMx\_ChannelDutySet Function](GUID-1E99241B-D462-4F6C-8FB7-BB452649033C.md)**  

-   **[PWMx\_ChannelCounterEventStatusGet Function](GUID-9DE5F9C2-F35A-4146-AE3B-C6DD69D9412B.md)**  

-   **[PWMx\_ChannelCounterEventEnable Function](GUID-F2CBF298-62EA-4247-AA80-542AEE8FE47C.md)**  

-   **[PWMx\_ChannelCounterEventDisable Function](GUID-EE38EB54-6E8F-4DC7-A17C-E63D7CCD1914.md)**  

-   **[PWMx\_CallbackRegister Function](GUID-9710228C-BB9B-4F14-8EF0-EE0E8A364036.md)**  

-   **[PWM\_CHANNEL\_NUM Enum](GUID-68921292-DFB5-4EAD-8C00-3E53014F6C32.md)**  

-   **[PWM\_CHANNEL\_MASK Enum](GUID-4143081E-05B3-4FD2-B14E-65DB3B0A5DBC.md)**  

-   **[PWM\_CALLBACK Typedef](GUID-A4F84B32-EEC2-4510-B984-34E3D1860644.md)**  


**Parent topic:**[SAM 9X60 Peripheral Libraries](GUID-CCAAC7F0-6BA8-4630-91AE-69718D188CBF.md)

**Parent topic:**[SAM 9X7 Peripheral Libraries](GUID-FB6741AA-355E-483F-9727-37728953D583.md)

