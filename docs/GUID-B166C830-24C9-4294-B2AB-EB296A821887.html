<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Divide and Square Root Accelerator (DIVAS)" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="divide-and-square-root-accelerator-divas" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Divide and Square Root Accelerator (DIVAS)</title>
<meta name="Microsoft.Help.Id" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8-divide-and-square-root-accelerator-divas" />
<meta name="Microsoft.Help.TocParent" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB® Harmony Peripheral Libraries Reference A 09/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-B166C830-24C9-4294-B2AB-EB296A821887"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="divide-and-square-root-accelerator-divas">
<h1 class="title topictitle1" id="ariaid-title1">Divide and Square Root Accelerator (DIVAS)</h1><div class="body"><p class="p">The Divide and Square Root Accelerator (DIVAS) is a programmable 32-bit signed or unsigned hardware divider and a 32-bit unsigned square root hardware engine. The DIVAS takes dividend and divisor values and returns the quotient and remainder when it is used as divider. The DIVAS takes unsigned input value and returns its square root and remainder when it is used as square root function.</p>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">This peripheral library provides an interface for the Divide and Square Root Accelerator on the device.The DIVAS is a programmable 32-bit signed or unsigned hardware divider and a 32-bit unsigned square root hardware engine. When running signed division, both the input and the result will be in two's complement format. The result of signed division is that the remainder has the same sign as the dividend and the quotient is negative if the dividend and divisor have opposite signs. When the square root input register is programmed, the square root function starts and the result will be stored in the Remainder register.</p>
<p class="p">There are two ways to use DIVAS in firmware:
Peripheral APIs
Operator overloading</p>
<p class="p">Peripheral APIs</p>
<p class="p">DIVAS can be accessed by application program interfaces like any other peripheral. Refer to Library Interface section for API details.</p>
<p class="p">Compiler Operator Overloading</p>
<p class="p">A simpler way of using DIVAS is making it invisible to the programmer. This can be achieved by replacing the back end for compiler intrinsic operators ‘/’ and ‘%’. When compiler compiles the statements containing these operators, it uses DIVAS APIs instead of library generated code automatically. Unfortunately, it is not possible for square root because square root does not have a C intrinsic operator.</p>
<p class="p">The operation is implemented automatically by EABI (Enhanced Application Binary Interface). EABI is a standard calling convention, which is defined by ARM. The four functions interface can implement division and mod operation in EABI.</p>
<p class="p">The following are the prototypes for EABI division operation in GNUC tool chain:</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d270496e31', this);">Copy</button><code id="d270496e31" content="int __aeabi_idiv(int numerator, int denominator);&#xA;unsigned __aeabi_uidiv(unsigned numerator, unsigned denominator);&#xA;uint64_t __aeabi_idivmod( int numerator, int denominator);&#xA;uint64_t uidiv_return __aeabi_uidivmod( unsigned numerator, unsigned denominator);&#xA;"><span class="ph token keyword">int</span> <span class="ph token function">__aeabi_idiv</span><span class="ph token punctuation">(</span><span class="ph token keyword">int</span> numerator<span class="ph token punctuation">,</span> <span class="ph token keyword">int</span> denominator<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token keyword">unsigned</span> <span class="ph token function">__aeabi_uidiv</span><span class="ph token punctuation">(</span><span class="ph token keyword">unsigned</span> numerator<span class="ph token punctuation">,</span> <span class="ph token keyword">unsigned</span> denominator<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
uint64_t <span class="ph token function">__aeabi_idivmod</span><span class="ph token punctuation">(</span> <span class="ph token keyword">int</span> numerator<span class="ph token punctuation">,</span> <span class="ph token keyword">int</span> denominator<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
uint64_t uidiv_return <span class="ph token function">__aeabi_uidivmod</span><span class="ph token punctuation">(</span> <span class="ph token keyword">unsigned</span> numerator<span class="ph token punctuation">,</span> <span class="ph token keyword">unsigned</span> denominator<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
</code></pre><p class="p">By using DIVAS module in the above four functions body, the user can transparently access the DIVAS module when writing normal C code. For example:</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d270496e119', this);">Copy</button><code id="d270496e119" content="void division(int32_t b, int32_t c)&#xA;{&#xA;   int32_t a;&#xA;   a = b / c;&#xA;   return a;&#xA;}"><span class="ph token keyword">void</span> <span class="ph token function">division</span><span class="ph token punctuation">(</span>int32_t b<span class="ph token punctuation">,</span> int32_t c<span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
   int32_t a<span class="ph token punctuation">;</span>
   a <span class="ph token operator">=</span> b <span class="ph token operator">/</span> c<span class="ph token punctuation">;</span>
   <span class="ph token keyword">return</span> a<span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span></code></pre><p class="p">Similarly, the user can use the "a = b % c;" symbol to implement the operation with DIVAS, and needn't to care about the internal operation process.</p>
<p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Divide and Square Root Accelerator peripheral library provides the following interfaces:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d270496e175"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d270496e177"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_Initialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>Initializes DIVAS peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_DivSigned</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>This function uses the DIVAS peripheral to performs a signed 32-bit division</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_DivUnsigned</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>This function uses the DIVAS peripheral to performs a unsigned 32-bit division</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_DivmodSigned</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>This function uses the DIVAS peripheral to performs a signed 32-bit division, and returns both the quotient and remainder as 64-bit number</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_DivmodUnsigned</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>This function uses the DIVAS peripheral to performs a unsigned 32-bit division, and returns both the quotient and remainder as 64-bit number</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e175 "><span>DIVAS_SquareRoot</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d270496e177 "><span>This function uses the DIVAS peripheral to perform a square root operation</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>