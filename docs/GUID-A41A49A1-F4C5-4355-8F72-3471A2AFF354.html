<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Peripheral Access Controller (PAC)" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="peripheral-access-controller-pac" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Peripheral Access Controller (PAC)</title>
<meta name="Microsoft.Help.Id" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8-peripheral-access-controller-pac" />
<meta name="Microsoft.Help.TocParent" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Peripheral Libraries Reference A 09/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-A41A49A1-F4C5-4355-8F72-3471A2AFF354"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="peripheral-access-controller-pac">
<h1 class="title topictitle1" id="ariaid-title1">Peripheral Access Controller (PAC)</h1><div class="body"><p class="p">The Peripheral Access Controller (PAC) provides interface to protect write access to a peripheral's registers to minimize risk of unintended configuration changes as a result of run-away code.</p>
<p class="p">The peripheral registers that can be protected is denoted by the "PAC Write-Protection" property in each individual register description.</p>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">The Peripheral Access Controller (PAC) provides interface to protect write access to a peripheral's registers to minimize risk of unintended configuration changes as a result of run-away code. The Following operations are provided to manage the peripheral access.</p>
<ul class="ul"><li class="li"><p class="p"><strong class="ph b">Clear Protection:</strong></p>
<ul class="ul"><li class="li"><p class="p">This operation will remove the write access protection for the selected peripheral to enable write access</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Set Protection:</strong></p>
<ul class="ul"><li class="li"><p class="p">This operation will set the write access protection for the selected peripheral to disable write access.</p>
</li>
</ul>
</li>
<li class="li"><p class="p"><strong class="ph b">Set and Lock Protection:</strong></p>
<ul class="ul"><li class="li"><p class="p">This operation will set the write access protection for the selected peripheral to disable write access and locks the access rights of the selected peripheral registers.</p>
</li>
<li class="li"><p class="p">The write access protection will only be cleared by a hardware reset.</p>
</li>
</ul>
</li>
</ul>
<p class="p">In an application where write protection is also modified in main and interrupt context, the interrupts must be disabled so that the interrupt can not happen while the main application manipulate the write protection status.</p>
<p class="p">The registered callback function will be called when Peripheral Access Error occurs due to the following:</p>
<ul class="ul"><li class="li"><p class="p">If a peripheral is write protected and if a write access is attempted, data will not be written and peripheral returns an access error.</p>
</li>
<li class="li"><p class="p">Attempting to set protection for the peripheral that is already set or attempting to clear protection for the peripheral that is already cleared. This is a safety feature to ensure correct program execution sequence to clear and set the protection.</p>
</li>
<li class="li"><p class="p">Access to an unimplemented register within the module.</p>
</li>
<li class="li"><p class="p">For write-synchronized registers an error will be reported if the register is written while a synchronization is ongoing.</p>
</li>
</ul>
<p class="p">The example code below demonstrates how to Clear/Set  protection for DSU peripheral using PAC.</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d863564e66', this);">Copy</button><code id="d863564e66" content="bool status = false;&#xA;&#xA;status = PAC_PeripheralIsProtected(PAC_PERIPHERAL_DSU);&#xA;&#xA;if (status == true)&#xA;{&#xA;    PAC_PeripheralProtectSetup(PAC_PERIPHERAL_DSU, PAC_PROTECTION_CLEAR);&#xA;}&#xA;else&#xA;{&#xA;    PAC_PeripheralProtectSetup(PAC_PERIPHERAL_DSU, PAC_PROTECTION_SET);&#xA;}">bool status <span class="ph token operator">=</span> false<span class="ph token punctuation">;</span>

status <span class="ph token operator">=</span> <span class="ph token function">PAC_PeripheralIsProtected</span><span class="ph token punctuation">(</span>PAC_PERIPHERAL_DSU<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

<span class="ph token keyword">if</span> <span class="ph token punctuation">(</span>status <span class="ph token operator">==</span> true<span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token function">PAC_PeripheralProtectSetup</span><span class="ph token punctuation">(</span>PAC_PERIPHERAL_DSU<span class="ph token punctuation">,</span> PAC_PROTECTION_CLEAR<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span>
<span class="ph token keyword">else</span>
<span class="ph token punctuation">{</span>
    <span class="ph token function">PAC_PeripheralProtectSetup</span><span class="ph token punctuation">(</span>PAC_PERIPHERAL_DSU<span class="ph token punctuation">,</span> PAC_PROTECTION_SET<span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span></code></pre><p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Peripheral Access Controller peripheral library provides the following interfaces:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d863564e157"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d863564e159"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e157 "><span>PAC_Initialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e159 "><span>Initializes given instance of PAC peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e157 "><span>PAC_PeripheralIsProtected</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e159 "><span>Returns PAC protection status of peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e157 "><span>PAC_PeripheralProtectSetup</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e159 "><span>This function configures PAC protection for the specified peripheral</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e157 "><span>PAC_CallbackRegister</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e159 "><span>Registers the function to be called when a PAC error has occurred</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Data types and constants</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d863564e192"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d863564e194"><span>Type</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d863564e196"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e192 "><span>PAC_PERIPHERAL</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e194 "><span>Enum</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e196 "><span>List of available Peripheral module on which errors will be detected</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e192 "><span>PAC_PROTECTION</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e194 "><span>Enum</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e196 "><span>List of available Peripheral Access Control Operations</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e192 "><span>PAC_CALLBACK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e194 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d863564e196 "><span>Defines the data type and function signature for the PAC peripheral callback function</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>