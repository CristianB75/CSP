<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Basic Timer Counter (TC)" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="basic-timer-counter-tc" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Basic Timer Counter (TC)</title>
<meta name="Microsoft.Help.Id" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8-basic-timer-counter-tc" />
<meta name="Microsoft.Help.TocParent" content="GUID-1EA9B250-D935-443A-9FA9-C48E50D229E8" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Peripheral Libraries Reference A 09/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-D805E0EA-6923-41A3-A27E-5A159783D12C"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="basic-timer-counter-tc">
<h1 class="title topictitle1" id="ariaid-title1">Basic Timer Counter (TC)</h1><div class="body"><p class="p">A Timer Counter (TC) module can operate in any one of the below three modes.
Timer mode - is used for periodic delay.
Compare mode is used to generate waveforms on WO<span class="xref"></span> and WO<span class="xref"></span>
Capture mode is used to measure delay, pulse width and frequency of the input signal. Capture trigger can be provided by input event line.</p>
<p class="p"><strong class="ph b">Timer mode</strong></p>
<p class="p">The TC in timer mode is used for periodic interrupt generation.
This provides below features:</p>
<ul class="ul"><li class="li"><p class="p">Selectable 8/16/32 bit counter</p>
</li>
<li class="li"><p class="p">Interrupts/output events on:</p>
</li>
<li class="li"><p class="p">Counter overflow/underflow</p>
</li>
<li class="li"><p class="p">Compare match</p>
</li>
</ul>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">When the timer is enabled, it increments by one on every rising edge of the input clock, and generates an interrupt on a period match (period is controlled by CC0 in MPWM waveform mode). Timer mode is used for periodic interrupt generation.</p>
<p class="p">It provides both polling and callback methods to indicate period match has occurred.</p>
<ul class="ul"><li class="li"><p class="p">With polling, the application will need to continuously poll to check if the timer has expired</p>
</li>
<li class="li"><p class="p">With callback, the registered callback function will be called when the timer expires(Application do not have to poll continuously)</p>
</li>
</ul>
<p class="p"><strong class="ph b">Polling method</strong></p>
<p class="p">This example demonstrates how to check if timer period is expired by
polling the status.</p>
<pre class="pre codeblock"><button title="Copy Code" class="copy-code" onclick="cpy('d279666e55', this);">Copy</button><code id="d279666e55" content="int main(void)&#xA;{&#xA;&#xA;    /* Start the timer instance 3*/&#xA;    TC3_TimerStart();&#xA;&#xA;    while (1)&#xA;    {&#xA;       while(! TC3_TimerPeriodHasExpired());&#xA;       LED_Toggle();&#xA;    }&#xA;&#xA;}">int main(void)
{

    /* Start the timer instance 3*/
    TC3_TimerStart();

    while (1)
    {
       while(! TC3_TimerPeriodHasExpired());
       LED_Toggle();
    }

}</code></pre><p class="p"><strong class="ph b">Callback method</strong></p>
<p class="p">This example demonstrates how to use TC in timer mode to
generate periodic callback.</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d279666e63', this);">Copy</button><code id="d279666e63" content="/* This function is called after period expires */&#xA;void TC3_Callback_InterruptHandler(TC_TIMER_STATUS status, uintptr_t context)&#xA;{&#xA;    /* Toggle LED */&#xA;    LED_Toggle();&#xA;}&#xA;&#xA;int main ( void )&#xA;{&#xA;    /* Initialize all modules */&#xA;    SYS_Initialize ( NULL );&#xA;&#xA;    /* Register callback function for TC3 period interrupt */&#xA;    TC3_TimerCallbackRegister(TC3_Callback_InterruptHandler, (uintptr_t)NULL);&#xA;&#xA;    /* Start the timer*/&#xA;    TC3_TimerStart();&#xA;&#xA;    while ( true )&#xA;    {&#xA;        /* Maintain state machines of all polled MPLAB Harmony modules. */&#xA;        SYS_Tasks ( );&#xA;    }&#xA;&#xA;    /* Execution should not come here during normal operation */&#xA;&#xA;    \return ( EXIT_FAILURE );&#xA;}"><span class="ph token comment">/* This function is called after period expires */</span>
<span class="ph token keyword">void</span> <span class="ph token function">TC3_Callback_InterruptHandler</span><span class="ph token punctuation">(</span>TC_TIMER_STATUS status<span class="ph token punctuation">,</span> uintptr_t context<span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token comment">/* Toggle LED */</span>
    <span class="ph token function">LED_Toggle</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span>

<span class="ph token keyword">int</span> main <span class="ph token punctuation">(</span> <span class="ph token keyword">void</span> <span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token comment">/* Initialize all modules */</span>
    SYS_Initialize <span class="ph token punctuation">(</span> <span class="ph token constant">NULL</span> <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

    <span class="ph token comment">/* Register callback function for TC3 period interrupt */</span>
    <span class="ph token function">TC3_TimerCallbackRegister</span><span class="ph token punctuation">(</span>TC3_Callback_InterruptHandler<span class="ph token punctuation">,</span> <span class="ph token punctuation">(</span>uintptr_t<span class="ph token punctuation">)</span><span class="ph token constant">NULL</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

    <span class="ph token comment">/* Start the timer*/</span>
    <span class="ph token function">TC3_TimerStart</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

    <span class="ph token keyword">while</span> <span class="ph token punctuation">(</span> true <span class="ph token punctuation">)</span>
    <span class="ph token punctuation">{</span>
        <span class="ph token comment">/* Maintain state machines of all polled MPLAB Harmony modules. */</span>
        SYS_Tasks <span class="ph token punctuation">(</span> <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    <span class="ph token punctuation">}</span>

    <span class="ph token comment">/* Execution should not come here during normal operation */</span>

    \<span class="ph token keyword">return</span> <span class="ph token punctuation">(</span> EXIT_FAILURE <span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span></code></pre><p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Basic Timer Counter peripheral library provides the following interfaces:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e226"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e228"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerInitialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Initializes given instance of TC</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerStart</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Starts the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerStop</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Stops the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer8bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer8bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer8bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer8bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer8bitCompareSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the compare value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer16bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer16bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer16bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer16bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer16bitCompareSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the compare value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer32bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer32bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer32bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer32bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_Timer32bitCompareSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Sets the compare value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerPeriodHasExpired</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Checks whether timer period is elapsed</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerFrequencyGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Provides the given timer's counter-increment frequency</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e226 "><span>TCx_TimerCallbackRegister</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e228 "><span>Registers the function to be called from interrupt</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Data types and constants</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e347"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e349"><span>Type</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e351"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e347 "><span>TC_TIMER_STATUS</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e349 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e351 "><span>Identifies channel interrupt source mask</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e347 "><span>TC_TIMER_CALLBACK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e349 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e351 "><span>Defines the function pointer data type and function signature for the TC channel callback function</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Compare mode</strong></p>
<p class="p">The TC channel in compare mode is used for waveform generation. This provides below features:</p>
<ul class="ul"><li class="li"><p class="p">Selectable 8/16/32 bit counter</p>
</li>
<li class="li"><p class="p">2 compare/capture channels (CC)</p>
</li>
<li class="li"><p class="p">Waveform configurations</p>
<ul class="ul"><li class="li"><p class="p">Normal Frequency - Period controlled by MAX (by PER in 8-bit mode)</p>
</li>
<li class="li"><p class="p">Match Frequency - Period controlled by CC0 to generates 50% duty cycle waveform</p>
</li>
<li class="li"><p class="p">Normal PWM - Period controlled by MAX (by PER in 8-bit mode) and duty controlled by CCx</p>
</li>
<li class="li"><p class="p">Match PWM - Period controlled by CC0 and duty controlled by CC1</p>
</li>
</ul>
</li>
<li class="li"><p class="p">Interrupts/output events on:</p>
<ul class="ul"><li class="li"><p class="p">Counter overflow/underflow</p>
</li>
<li class="li"><p class="p">Compare match</p>
</li>
</ul>
</li>
</ul>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">When using the TC and the Compare/Capture Value registers (CCx) for compare operations, the counter value is continuously compared to the values in the CCx registers. Output polarity can be reversed by inverting the output waveforms. This library provides below waveform types:</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e422"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e424"><span>Operation</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e426"><span>TOP</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e428"><span>Update</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e430"><span>Output on match</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e432"><span>Output on update</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e422 "><span>MFRQ (output on WO<span class="xref"></span> )</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e424 "><span>Match Frequency</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e426 "><span>CC0</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e428 "><span>TOP/ZERO</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e430 "><span>Toggle</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e432 "><span>Stable</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e422 "><span>MPWM (output on WO<span class="xref"></span> )</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e424 "><span>Match PWM</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e426 "><span>CC0</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e428 "><span>TOP/ZERO</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e430 "><span>Toggle</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e432 "><span>Toggle</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p">In compare mode, overflow interrupt and compare match interrupts can be used to change the frequency or duty cycle of the waveform.</p>
<p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Basic Timer Counter peripheral library provides the following interfaces for compare operations:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e483"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e485"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareInitialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Initializes given instance of TC</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareStart</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Starts the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareStop</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Stops the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitMatch0Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare8bitMatch1Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitMatch0Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare16bitMatch1Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitPeriodSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets the period value of a given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitPeriodGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the period value of given timer</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitCounterGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads the timer current count value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitCounterSet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Sets new timer counter value</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitMatch0Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_Compare32bitMatch1Set</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Writes compare value of the given compare channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareFrequencyGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Provides the given timer's counter-increment frequency</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareCallbackRegister</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Registers the function to be called from interrupt</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e483 "><span>TCx_CompareStatusGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e485 "><span>Reads status of compare operation</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Data types and constants</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e620"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e622"><span>Type</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e624"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e620 "><span>TCx_COMPARE_STATUS</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e622 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e624 "><span>Identifies channel interrupt source mask</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e620 "><span>TCx_COMPARE_CALLBACK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e622 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e624 "><span>Defines the function pointer data type and function signature for the tc channel callback function</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Capture mode</strong></p>
<p class="p">The TC channel in capture mode is used to measure pulse width, period,
timestamp. A capture trigger can be provided by input event line TC_EV.
This provides below features:</p>
<ul class="ul"><li class="li"><p class="p">Selectable 8/16/32 bit counter</p>
</li>
<li class="li"><p class="p">Input capture</p>
<ul class="ul"><li class="li"><p class="p">Period captured in CC0 and pulse width in CC1</p>
</li>
<li class="li"><p class="p">Period captured in CC1 and pulse width in CC0</p>
</li>
</ul>
</li>
<li class="li"><p class="p">Interrupts/output events on:</p>
<ul class="ul"><li class="li"><p class="p">Capture</p>
</li>
</ul>
</li>
<li class="li"><p class="p">DMA support</p>
</li>
</ul>
<p class="p"><strong class="ph b">Using The Library</strong></p>
<p class="p">Capture trigger can be provided by</p>
<ul class="ul"><li class="li"><p class="p">Input event line TC_EV</p>
<ul class="ul"><li class="li"><p class="p">Only one event input line is available</p>
</li>
<li class="li"><p class="p">This provides different capture event actions:</p>
<ul class="ul"><li class="li"><p class="p">Pulse width in CC0 and period in CC1</p>
</li>
<li class="li"><p class="p">Pulse width in CC1 and period in CC0</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="p">It provides both polling and callback methods to indicate capture event
has occurred.</p>
<ul class="ul"><li class="li"><p class="p">With polling, the application will need to continuously poll to check if the capture event has occurred.</p>
</li>
<li class="li"><p class="p">With callback, the registered callback function will be called when the capture event occurs. This means the application do not have to poll continuously.</p>
</li>
</ul>
<p class="p"><strong class="ph b">Callback method</strong></p>
<p class="p">This example demonstrates how to use TC in capture mode to measure on time and period. CC0 captures on time and CC1 captures period of the input event. Event action is configured as PWP (Pulse width in CC0 and period in CC1).</p>
<pre class="pre codeblock language-c"><button title="Copy Code" class="copy-code" onclick="cpy('d279666e708', this);">Copy</button><code id="d279666e708" content="/ * This function is called after Capture 0 interrupt  */&#xA;void TC3_CaptureInterruptHandler(TC_CAPTURE_STATUS status, uintptr_t context)&#xA;{&#xA;    / * Read Captured values  */&#xA;    on_time = TC3_Capture16bitChannel0Get();&#xA;    period = TC3_Capture16bitChannel1Get();&#xA;}&#xA;&#xA;int main(void)&#xA;{&#xA;&#xA;    / * Register callback function for period interrupt  */&#xA;    TC3_CaptureCallbackRegister(TC3_CaptureInterruptHandler, (uintptr_t)NULL);&#xA;&#xA;    / * Start the Capture  */&#xA;    TC3_CaptureStart();&#xA;}"><span class="ph token operator">/</span> <span class="ph token operator">*</span> This function is called after Capture <span class="ph token number">0</span> interrupt  <span class="ph token operator">*</span><span class="ph token operator">/</span>
<span class="ph token keyword">void</span> <span class="ph token function">TC3_CaptureInterruptHandler</span><span class="ph token punctuation">(</span>TC_CAPTURE_STATUS status<span class="ph token punctuation">,</span> uintptr_t context<span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>
    <span class="ph token operator">/</span> <span class="ph token operator">*</span> Read Captured values  <span class="ph token operator">*</span><span class="ph token operator">/</span>
    on_time <span class="ph token operator">=</span> <span class="ph token function">TC3_Capture16bitChannel0Get</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
    period <span class="ph token operator">=</span> <span class="ph token function">TC3_Capture16bitChannel1Get</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span>

<span class="ph token keyword">int</span> <span class="ph token function">main</span><span class="ph token punctuation">(</span><span class="ph token keyword">void</span><span class="ph token punctuation">)</span>
<span class="ph token punctuation">{</span>

    <span class="ph token operator">/</span> <span class="ph token operator">*</span> Register callback function <span class="ph token keyword">for</span> period interrupt  <span class="ph token operator">*</span><span class="ph token operator">/</span>
    <span class="ph token function">TC3_CaptureCallbackRegister</span><span class="ph token punctuation">(</span>TC3_CaptureInterruptHandler<span class="ph token punctuation">,</span> <span class="ph token punctuation">(</span>uintptr_t<span class="ph token punctuation">)</span><span class="ph token constant">NULL</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>

    <span class="ph token operator">/</span> <span class="ph token operator">*</span> Start the Capture  <span class="ph token operator">*</span><span class="ph token operator">/</span>
    <span class="ph token function">TC3_CaptureStart</span><span class="ph token punctuation">(</span><span class="ph token punctuation">)</span><span class="ph token punctuation">;</span>
<span class="ph token punctuation">}</span></code></pre><p class="p"><strong class="ph b">Library Interface</strong></p>
<p class="p">Basic Timer Counter peripheral library provides the following interfaces for capture operations:</p>
<p class="p"><strong class="ph b">Functions</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e871"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e873"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_CaptureInitialize</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Initializes given instance of TC</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_CaptureStart</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Starts the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_CaptureStop</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Stops the timer for given TC instance</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture8bitChannel0Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture16bitChannel0Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture32bitChannel0Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 0</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture8bitChannel1Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture16bitChannel1Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_Capture32bitChannel1Get</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads capture value from channel 1</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_CaptureStatusGet</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Reads status capture operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e871 "><span>TCx_CaptureCallbackRegister</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e873 "><span>Registers the function to be called from interrupt</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">Data types and constants</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e941"><span>Name</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e943"><span>Type</span></th>
<th class="entry cellrowborder" style="text-align:left;vertical-align:middle;" id="d279666e945"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e941 "><span>TCx_CAPTURE_STATUS</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e943 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e945 "><span>Identifies channel interrupt source mask</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e941 "><span>TCx_CAPTURE_CALLBACK</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e943 "><span>Typedef</span></td>
<td class="entry cellrowborder" style="text-align:left;vertical-align:middle;" headers="d279666e945 "><span>Defines the function pointer data type and function signature for the tc channel callback function</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>