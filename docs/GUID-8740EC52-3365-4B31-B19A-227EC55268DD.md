# Analog to Digital Converter \(ADCHS\)

-   12-bit Analog to Digital Converter

-   18 Msps with up to six ADC circuits \(five dedicated and one shared\)

-   Up to 45 analog input

-   Can operate during Sleep and Idle modes

-   Multiple trigger sources

-   Six Digital Comparators and six Digital Filters


**Using The Library**

**Interrupt mode:**

```c
#include <stddef.h>                     // Defines NULL
#include <stdbool.h>                    // Defines true
#include <stdlib.h>                     // Defines EXIT_FAILURE
#include "definitions.h"                // SYS function prototypes

#define ADC_VREF                (3.3f)
#define ADC_MAX_COUNT           (4095)

uint16_t adc_count;
float input_voltage;
volatile bool result_ready = false;

// *****************************************************************************
// *****************************************************************************
// Section: Main Entry Point
// *****************************************************************************
// *****************************************************************************

void ADC_ResultHandler(ADCHS_CHANNEL_NUM channel, uintptr_t context)
{
    /* Read the ADC result */
    adc_count = ADCHS_ChannelResultGet(ADCHS_CH3);    
    result_ready = true;
}


int main ( void )
{
    /* Initialize all modules */
    SYS_Initialize ( NULL );
    
    printf("\n\r---------------------------------------------------------");
    printf("\n\r                    ADC Interrupt Mode Demo                 ");
    printf("\n\r---------------------------------------------------------\n\r"); 
    
    ADCHS_CallbackRegister(ADCHS_CH3, ADC_ResultHandler, (uintptr_t)NULL);
    TMR3_Start();
    
    while ( true )
    {
        /* Maintain state machines of all polled MPLAB Harmony modules. */
        SYS_Tasks ( );
        
        /* Wait till ADC conversion result is available */
        if (result_ready == true)
        {
            result_ready = false;
            input_voltage = (float)adc_count * ADC_VREF / ADC_MAX_COUNT;

            printf("ADC Count = 0x%03x, ADC Input Voltage = %d.%02d V \r", adc_count, (int)input_voltage, (int)((input_voltage - (int)input_voltage)*100.0));        
        }
    }

    /* Execution should not come here during normal operation */

    return ( EXIT_FAILURE );
}
```

**Polling mode:**

```c
#include <stddef.h>                     // Defines NULL
#include <stdbool.h>                    // Defines true
#include <stdlib.h>                     // Defines EXIT_FAILURE
#include "definitions.h"                // SYS function prototypes

#define ADC_VREF                (3.3f)
#define ADC_MAX_COUNT           (4095)

uint16_t adc_count;
float input_voltage;

// *****************************************************************************
// *****************************************************************************
// Section: Main Entry Point
// *****************************************************************************
// *****************************************************************************

int main ( void )
{
    /* Initialize all modules */
    SYS_Initialize ( NULL );
    
    printf("\n\r---------------------------------------------------------");
    printf("\n\r                    ADC Polled Mode Demo                 ");
    printf("\n\r---------------------------------------------------------\n\r"); 
    
    TMR3_Start();
    
    while ( true )
    {
        /* Maintain state machines of all polled MPLAB Harmony modules. */
        SYS_Tasks ( );
        
        /* Wait till ADC conversion result is available */
        while(!ADCHS_ChannelResultIsReady(ADCHS_CH3))
        {

        };

        /* Read the ADC result */
        adc_count = ADCHS_ChannelResultGet(ADCHS_CH3);
        input_voltage = (float)adc_count * ADC_VREF / ADC_MAX_COUNT;

        printf("ADC Count = 0x%03x, ADC Input Voltage = %d.%02d V \r", adc_count, (int)input_voltage, (int)((input_voltage - (int)input_voltage)*100.0));        
    }

    /* Execution should not come here during normal operation */

    return ( EXIT_FAILURE );
}
```

**Library Interface**

12-bit Analog to Digital Converter peripheral library provides the following interfaces:

**Functions**

|Name|Description|
|----|-----------|
|ADCHS\_Initialize|Initializes given instance of ADCHS peripheral|
|ADCHS\_ModulesEnable|Enables the ADC modules|
|ADCHS\_ModulesDisable|Disables the ADC modules|
|ADCHS\_ChannelResultInterruptEnable|Enables the ADC channel result data interrupt|
|ADCHS\_ChannelResultInterruptDisable|Disables the ADC channel result data interrupt|
|ADCHS\_ChannelEarlyInterruptEnable|Enables the ADC channel early result data interrupt|
|ADCHS\_ChannelEarlyInterruptDisable|Disables the ADC channel early result data interrupt|
|ADCHS\_ChannelConversionStart|Starts the ADC conversion of an analog channel|
|ADCHS\_GlobalEdgeConversionStart|Starts the ADC conversion of analog channels configured for global software edge trigger|
|ADCHS\_GlobalLevelConversionStart|Starts the ADC conversion of analog channels configured for global software level trigger|
|ADCHS\_GlobalLevelConversionStop|Stops the global software level trigger|
|ADCHS\_ChannelResultIsReady|Returns the status of the channel conversion|
|ADCHS\_EOSStatusGet|Returns the status of the end of scan interrupt flag|
|ADCHS\_ChannelResultGet|Reads the conversion result of the channel|
|ADCHS\_CallbackRegister|Registers the function to be called from interrupt|
|ADCHS\_EOSCallbackRegister|Registers the function to be called from end of scan interrupt|
|ADCHS\_DMASampleCountBaseAddrSet|Registers the user-defined RAM address at which the DMA engine will start saving the current count of output samples|
|ADCHS\_DMAResultBaseAddrSet|Registers the user-defined RAM address at which the DMA engine will start saving the converted data|
|ADCHS\_DMACallbackRegister|Registers the application event handler which is called when the DMA transfer is complete|
|ADCHS\_DMAStatusGet|Returns the DMA transfer status|
|ADCHS\_ComparatorxEnable|Enables comparator|
|ADCHS\_ComparatorxDisable|Disables comparator|
|ADCHS\_ComparatorxLimitSet|Sets lower and higher threshold for comparator|
|ADCHS\_ComparatorxEventModeSet|Sets the condition under which the comparator output becomes true|
|ADCHS\_ComparatorxAnalogInputIDGet|Identifies the analog input for which the comparator event is generated|
|ADCHS\_ComparatorxCallbackRegister|Registers the function to be called from the ADC comparator interrupt|
|ADCHS\_ComparatorxStatusGet|Returns the Comparator status|
|ADCHS\_FilterxIsReady|Returns the status of ADC filter|
|ADCHS\_FilterxDataGet|Returns the ADC filter data|
|ADCHS\_FilterxCallbackRegister|Registers the function to be called from the ADC filter ready interrupt|

**Data types and constants**

|Name|Type|Description|
|----|----|-----------|
|ADCHS\_MODULE\_MASK|Enum|Identifies dedicated and shared ADC module mask|
|ADCHS\_CHANNEL\_NUM|Enum|Identifies ADCHS inputs as analog channel number|
|ADCHS\_CMP\_EVENT\_MODE|Enum|Identifies ADCHS comparator event modes|
|ADCHS\_DMA\_STATUS|Enum|Identifies ADCHS DMA status|
|ADCHS\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the adchs peripheral callback function|
|ADCHS\_DC\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the adchs digital comparator interrupt callback function|
|ADCHS\_DF\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the adchs digital filter interrupt callback function|
|ADCHS\_DMA\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the adchs DMA interrupt callback function|
|ADCHS\_EOS\_CALLBACK|Typedef|Defines the function pointer data type and function signature for the adchs end of scan interrupt callback function|
|ADCHS\_CALLBACK\_OBJECT|Struct|ADCHS Callback structure|
|ADCHS\_EOS\_CALLBACK\_OBJECT|Struct|ADCHS Callback structure for End of Scan \(EOS\) interrupt|

-   **[ADCHS\_Initialize Function](GUID-FB271030-94C1-489F-ABBC-61EA4586B5F2.md)**  

-   **[ADCHS\_ModulesEnable Function](GUID-403B6B31-0D13-4793-A78D-E6401B44E94B.md)**  

-   **[ADCHS\_ModulesDisable Function](GUID-61581D16-E7C8-4ADA-AA3C-5CB266C5E7A4.md)**  

-   **[ADCHS\_ChannelResultInterruptEnable Function](GUID-3388131C-529C-4676-894C-22CEAF705721.md)**  

-   **[ADCHS\_ChannelResultInterruptDisable Function](GUID-1776B2A2-FA22-4847-8E87-6791FC417951.md)**  

-   **[ADCHS\_ChannelEarlyInterruptEnable Function](GUID-EEC67AF0-F259-4967-9DA2-9B166A866EF0.md)**  

-   **[ADCHS\_ChannelEarlyInterruptDisable Function](GUID-A05FCBB8-2782-49DD-9459-8BD5C5BF9F52.md)**  

-   **[ADCHS\_ChannelConversionStart Function](GUID-02EA4AE1-9A20-4E68-876C-A4DD28708302.md)**  

-   **[ADCHS\_GlobalEdgeConversionStart Function](GUID-35A00E70-3F5C-4354-9407-C6459F851918.md)**  

-   **[ADCHS\_GlobalLevelConversionStart Function](GUID-EDAFF5DC-1899-4E82-9F57-E167890859D9.md)**  

-   **[ADCHS\_GlobalLevelConversionStop Function](GUID-C8581E0C-2C74-4781-811B-A56F772B1EF1.md)**  

-   **[ADCHS\_ChannelResultIsReady Function](GUID-8216A4F1-EF05-4950-83C1-B8E1F76D4B41.md)**  

-   **[ADCHS\_EOSStatusGet Function](GUID-BFE59E49-C206-48C8-AFCD-DBD7BACD7C35.md)**  

-   **[ADCHS\_ChannelResultGet Function](GUID-978CE388-55A7-472A-8CFB-2F65D9A0D1BF.md)**  

-   **[ADCHS\_CallbackRegister Function](GUID-BAF75B83-7CEF-4A1E-8822-48E0FBBD1BEC.md)**  

-   **[ADCHS\_EOSCallbackRegister Function](GUID-0C7CBA20-C356-4B8E-AE1F-28879247BBD4.md)**  

-   **[ADCHS\_DMASampleCountBaseAddrSet Function](GUID-49AEA8F1-9BDB-427F-B86A-71CB36785559.md)**  

-   **[ADCHS\_DMAResultBaseAddrSet Function](GUID-347A97A9-2E2A-4C3E-B96F-DB2B6C43D22C.md)**  

-   **[ADCHS\_DMACallbackRegister Function](GUID-A399FDC2-0A65-484B-8921-47EE7F487B9A.md)**  

-   **[ADCHS\_DMAStatusGet Function](GUID-EB567A84-B12C-4A85-A002-5301663178B5.md)**  

-   **[ADCHS\_ComparatorxEnable Function](GUID-F93D99BA-EFB2-4C3D-BB02-B3C56C144E25.md)**  

-   **[ADCHS\_ComparatorxDisable Function](GUID-1CC568E2-4327-458C-9FA1-8DAC9B45DFBD.md)**  

-   **[ADCHS\_ComparatorxLimitSet Function](GUID-BA59E6A7-05C8-4205-A47D-52A96510D4D2.md)**  

-   **[ADCHS\_ComparatorxEventModeSet Function](GUID-A039741B-8A0E-4F00-AF18-17559E879365.md)**  

-   **[ADCHS\_ComparatorxAnalogInputIDGet Function](GUID-367503F0-FAE4-4838-9D83-CA966BD824A4.md)**  

-   **[ADCHS\_ComparatorxCallbackRegister Function](GUID-D16B6109-C11E-4DB0-B778-662F59509EC5.md)**  

-   **[ADCHS\_ComparatorxStatusGet Function](GUID-741A692C-ADCC-452F-BD30-2C2902508F69.md)**  

-   **[ADCHS\_FilterxIsReady Function](GUID-D02388D8-4E80-41B7-8C0E-B6EC7D49982E.md)**  

-   **[ADCHS\_FilterxDataGet Function](GUID-9E3AC452-029C-4775-ADD8-C32E6DBB3199.md)**  

-   **[ADCHS\_FilterxCallbackRegister Function](GUID-3597D4B9-1C93-4718-8786-904C623103F7.md)**  

-   **[ADCHS\_MODULE\_MASK Enum](GUID-18AF6EFD-E174-4CF4-97B9-55A1C3D0F0A0.md)**  

-   **[ADCHS\_CHANNEL\_NUM Enum](GUID-F75ACF80-E2A3-4AA0-8C65-04FD9F6AFCB8.md)**  

-   **[ADCHS\_CMP\_EVENT\_MODE Enum](GUID-50A8659E-6148-46EE-8D6F-419E4AC1E9C2.md)**  

-   **[ADCHS\_DMA\_STATUS Enum](GUID-C8F685B3-C95A-4A38-807D-7E33742FF59D.md)**  

-   **[ADCHS\_CALLBACK Typedef](GUID-5991CB13-622E-41BB-81D3-A49A7AD5FFF6.md)**  

-   **[ADCHS\_DC\_CALLBACK Typedef](GUID-7B16A1BC-0783-4CFF-B4C6-A8C2EB76FE07.md)**  

-   **[ADCHS\_DF\_CALLBACK Typedef](GUID-B408B2C5-E0AB-4EB3-B839-B670A553882F.md)**  

-   **[ADCHS\_DMA\_CALLBACK Typedef](GUID-8EE7A19E-EC8C-44D6-BEFB-5282A6DBFB80.md)**  

-   **[ADCHS\_EOS\_CALLBACK Typedef](GUID-02077FC2-D163-4BFF-9C56-712C9329FA34.md)**  

-   **[ADCHS\_CALLBACK\_OBJECT Struct](GUID-DE677DDD-A279-42FA-AC05-E0F1DCB32AB1.md)**  

-   **[ADCHS\_EOS\_CALLBACK\_OBJECT Struct](GUID-EEA9773F-5877-4FDD-834D-96A1C7875058.md)**  


**Parent topic:**[PIC32CX BZ2 WBZ45 Peripheral Libraries](GUID-3D519D00-FDEE-4A3E-9EF7-20F335E64CEE.md)

**Parent topic:**[PIC32CX BZ3 WBZ3 Peripheral Libraries](GUID-5752DD6D-6E5D-484D-B564-DA87788492F3.md)

**Parent topic:**[PIC32MK GPD GPE MCF Peripheral Libraries](GUID-A63F4C14-72E7-44D7-9C70-A48BBD41B583.md)

**Parent topic:**[PIC32MK GPG MCJ Peripheral Libraries](GUID-A0350A48-03F7-4370-A6C5-612386A4ABAC.md)

**Parent topic:**[PIC32MK GPK MCM Peripheral Libraries](GUID-801B9DE7-4616-4E38-BF86-C82B78A4F430.md)

**Parent topic:**[PIC32MK MCA Peripheral Libraries](GUID-E11C5899-DD12-4B78-8076-8A415C20F144.md)

**Parent topic:**[PIC32MZ DA Peripheral Libraries](GUID-02A4B196-FE06-48DB-BC12-D3A68B6D983E.md)

**Parent topic:**[PIC32MZ EF Peripheral Libraries](GUID-F47955F5-89DE-43B0-8C2C-DE0070EBA152.md)

**Parent topic:**[PIC32MZ W1 Peripheral Libraries](GUID-EBD28D67-7F6E-46D1-9ABE-2BDE1973D143.md)

